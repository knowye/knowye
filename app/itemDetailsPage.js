/*
 * JS for itemDetailsPage generated by Appery.io
 */
Apperyio.getProjectGUID = function() {
    return '148444cb-eb26-4cec-bc22-29bf794bc529';
};

function navigateTo(outcome, useAjax) {
    Apperyio.navigateTo(outcome, useAjax);
}

function adjustContentHeight() {
    Apperyio.adjustContentHeightWithPadding();
}

function adjustContentHeightWithPadding(_page) {
    Apperyio.adjustContentHeightWithPadding(_page);
}

function setDetailContent(pageUrl) {
    Apperyio.setDetailContent(pageUrl);
}
Apperyio.AppPages = [{
    "name": "aboutPage",
    "location": "aboutPage.html"
}, {
    "name": "itemDetailsPage",
    "location": "itemDetailsPage.html"
}, {
    "name": "menuHeadingManagePage",
    "location": "menuHeadingManagePage.html"
}, {
    "name": "proprietorAnalyticsPage",
    "location": "proprietorAnalyticsPage.html"
}, {
    "name": "zzpromoEdit",
    "location": "zzpromoEdit.html"
}, {
    "name": "startScreen",
    "location": "startScreen.html"
}, {
    "name": "itemPage",
    "location": "itemPage.html"
}, {
    "name": "zzpromoManage",
    "location": "zzpromoManage.html"
}, {
    "name": "zzscannerPage",
    "location": "zzscannerPage.html"
}, {
    "name": "zztimeRangePage",
    "location": "zztimeRangePage.html"
}, {
    "name": "selectedPage",
    "location": "selectedPage.html"
}, {
    "name": "zzCSStestPage",
    "location": "zzCSStestPage.html"
}, {
    "name": "zzmenuPage",
    "location": "zzmenuPage.html"
}, {
    "name": "menuHistoryPage",
    "location": "menuHistoryPage.html"
}, {
    "name": "faqPage",
    "location": "faqPage.html"
}, {
    "name": "zzratingInfoPage",
    "location": "zzratingInfoPage.html"
}, {
    "name": "orderHistoryPage",
    "location": "orderHistoryPage.html"
}, {
    "name": "createAccount",
    "location": "createAccount.html"
}, {
    "name": "itemManagePage",
    "location": "itemManagePage.html"
}, {
    "name": "proprietorStartPage",
    "location": "proprietorStartPage.html"
}, {
    "name": "operationsRestaurantPage",
    "location": "operationsRestaurantPage.html"
}, {
    "name": "zzdetailedReviewPage",
    "location": "zzdetailedReviewPage.html"
}, {
    "name": "itemEditPage",
    "location": "itemEditPage.html"
}, {
    "name": "selectionHistoryPage",
    "location": "selectionHistoryPage.html"
}, {
    "name": "zzproprietorStatPage",
    "location": "zzproprietorStatPage.html"
}, {
    "name": "zzitemInventoryPage",
    "location": "zzitemInventoryPage.html"
}, {
    "name": "zzalertPage",
    "location": "zzalertPage.html"
}, {
    "name": "zzsearchPage",
    "location": "zzsearchPage.html"
}, {
    "name": "menuPage_v2",
    "location": "menuPage_v2.html"
}, {
    "name": "zzqrCodePage",
    "location": "zzqrCodePage.html"
}, {
    "name": "profilePage",
    "location": "profilePage.html"
}, {
    "name": "filterPage",
    "location": "filterPage.html"
}, {
    "name": "easterEggPage",
    "location": "easterEggPage.html"
}, {
    "name": "helpPage",
    "location": "helpPage.html"
}, {
    "name": "navigatePage",
    "location": "navigatePage.html"
}, {
    "name": "menuPreviewPage",
    "location": "menuPreviewPage.html"
}, {
    "name": "zzfacebookLogin",
    "location": "zzfacebookLogin.html"
}, {
    "name": "menu_shared",
    "location": "menu_shared.html"
}, {
    "name": "logoutPage",
    "location": "logoutPage.html"
}, {
    "name": "favoritesPage",
    "location": "favoritesPage.html"
}, {
    "name": "proprietorPage",
    "location": "proprietorPage.html"
}, {
    "name": "wishListPage",
    "location": "wishListPage.html"
}, {
    "name": "menuManagementPage",
    "location": "menuManagementPage.html"
}, {
    "name": "touPage",
    "location": "touPage.html"
}, {
    "name": "zzsettingsPage",
    "location": "zzsettingsPage.html"
}];

function itemDetailsPage_js() {
    /* Object & array with components "name-to-id" mapping */
    var n2id_buf = {
        'navigateButton': 'itemDetailsPage_navigateButton',
        'proprietorNameLabel': 'itemDetailsPage_proprietorNameLabel',
        'mapLink': 'itemDetailsPage_mapLink',
        'itemLabel': 'itemDetailsPage_itemLabel',
        'itemPrefs': 'itemDetailsPage_itemPrefs',
        'itemDetailLabelTemp': 'itemDetailsPage_itemDetailLabelTemp',
        'itemDetailLabel': 'itemDetailsPage_itemDetailLabel',
        'notAvailableLabel': 'itemDetailsPage_notAvailableLabel',
        'detailGrid': 'itemDetailsPage_detailGrid',
        'iconCell': 'itemDetailsPage_iconCell',
        'iconLink': 'itemDetailsPage_iconLink',
        'priceAmountCell': 'itemDetailsPage_priceAmountCell',
        'price': 'itemDetailsPage_price',
        'ratingCell': 'itemDetailsPage_ratingCell',
        'rateStars': 'itemDetailsPage_rateStars',
        'ratingLabel2': 'itemDetailsPage_ratingLabel2',
        'ratingGrid': 'itemDetailsPage_ratingGrid',
        'percentCell2': 'itemDetailsPage_percentCell2',
        'plus2PercentLabel': 'itemDetailsPage_plus2PercentLabel',
        'percent2Cell': 'itemDetailsPage_percent2Cell',
        'percent2Label': 'itemDetailsPage_percent2Label',
        'plus2CountCell': 'itemDetailsPage_plus2CountCell',
        'plus2CountLabel': 'itemDetailsPage_plus2CountLabel',
        'plus2LabelCell': 'itemDetailsPage_plus2LabelCell',
        'plus2Label': 'itemDetailsPage_plus2Label',
        'percentCell1': 'itemDetailsPage_percentCell1',
        'plus1PercentLabel': 'itemDetailsPage_plus1PercentLabel',
        'percent1Cell': 'itemDetailsPage_percent1Cell',
        'percent1Label': 'itemDetailsPage_percent1Label',
        'plus1CountCell': 'itemDetailsPage_plus1CountCell',
        'plus1CountLabel': 'itemDetailsPage_plus1CountLabel',
        'plus1LabelCell': 'itemDetailsPage_plus1LabelCell',
        'plus1Label': 'itemDetailsPage_plus1Label',
        'statSpacingGrid': 'itemDetailsPage_statSpacingGrid',
        'mobilegridcell_65': 'itemDetailsPage_mobilegridcell_65',
        'statScoreCell': 'itemDetailsPage_statScoreCell',
        'mobilegridcell_69': 'itemDetailsPage_mobilegridcell_69',
        'ratingAboutButton': 'itemDetailsPage_ratingAboutButton',
        'guestItemRatingGrid': 'itemDetailsPage_guestItemRatingGrid',
        'guestItemRatingCell': 'itemDetailsPage_guestItemRatingCell',
        'guestRatingLabel': 'itemDetailsPage_guestRatingLabel',
        'guestItemRating': 'itemDetailsPage_guestItemRating',
        'pairingGrid': 'itemDetailsPage_pairingGrid',
        'pairingLabelCell': 'itemDetailsPage_pairingLabelCell',
        'pairingLabel': 'itemDetailsPage_pairingLabel',
        'pairingCollapsibleSet': 'itemDetailsPage_pairingCollapsibleSet',
        'mobilecollapsblock_99': 'itemDetailsPage_mobilecollapsblock_99',
        'mobilecollapsblockheader_100': 'itemDetailsPage_mobilecollapsblockheader_100',
        'mobilecollapsblockcontent_101': 'itemDetailsPage_mobilecollapsblockcontent_101',
        'pairingList': 'itemDetailsPage_pairingList',
        'pairingItem': 'itemDetailsPage_pairingItem',
        'mobilelistitembutton_86': 'itemDetailsPage_mobilelistitembutton_86',
        'itemName': 'itemDetailsPage_itemName',
        'mobilegrid_93': 'itemDetailsPage_mobilegrid_93',
        'mobilegridcell_94': 'itemDetailsPage_mobilegridcell_94',
        'itemPrice': 'itemDetailsPage_itemPrice',
        'mobilegridcell_95': 'itemDetailsPage_mobilegridcell_95',
        'pairingListCell': 'itemDetailsPage_pairingListCell',
        'itemSelectButton': 'itemDetailsPage_itemSelectButton',
        'rateItemButton': 'itemDetailsPage_rateItemButton',
        'addWishListButton': 'itemDetailsPage_addWishListButton',
        'addFavoriteButton': 'itemDetailsPage_addFavoriteButton',
        'shareItemButton': 'itemDetailsPage_shareItemButton',
        'buyButton': 'itemDetailsPage_buyButton',
        'itemImageGrid': 'itemDetailsPage_itemImageGrid',
        'itemImageGridCell': 'itemDetailsPage_itemImageGridCell',
        'itemImage': 'itemDetailsPage_itemImage',
        'review': 'itemDetailsPage_review',
        'selectedButton': 'itemDetailsPage_selectedButton',
        'ratingLabel': 'itemDetailsPage_ratingLabel',
        'detailedRatingButton': 'itemDetailsPage_detailedRatingButton',
        'tasteRatingChoices': 'itemDetailsPage_tasteRatingChoices',
        'rating5': 'itemDetailsPage_rating5',
        'rating4': 'itemDetailsPage_rating4',
        'rating3': 'itemDetailsPage_rating3',
        'rating2': 'itemDetailsPage_rating2',
        'rating1': 'itemDetailsPage_rating1',
        'ratingButtonGrid': 'itemDetailsPage_ratingButtonGrid',
        'ratingSaveCell': 'itemDetailsPage_ratingSaveCell',
        'submitTasteButton': 'itemDetailsPage_submitTasteButton',
        'ratingCancelCell': 'itemDetailsPage_ratingCancelCell',
        'ratingCancelButton': 'itemDetailsPage_ratingCancelButton',
        'wishListPopupLabel': 'itemDetailsPage_wishListPopupLabel',
        'wishListNote': 'itemDetailsPage_wishListNote',
        'gotoWishListButton': 'itemDetailsPage_gotoWishListButton',
        'wishlistNotesButtonGrid': 'itemDetailsPage_wishlistNotesButtonGrid',
        'mobilegridcell_110': 'itemDetailsPage_mobilegridcell_110',
        'closePopupButton': 'itemDetailsPage_closePopupButton',
        'wishlistNotesCancelcell': 'itemDetailsPage_wishlistNotesCancelcell',
        'wishlistNotesCancelButton': 'itemDetailsPage_wishlistNotesCancelButton',
        'favoritesPopupLabel': 'itemDetailsPage_favoritesPopupLabel',
        'favoritesAlreadyAdded': 'itemDetailsPage_favoritesAlreadyAdded',
        'wishlistContainsItemLabel': 'itemDetailsPage_wishlistContainsItemLabel',
        'addToOrderPopupLabel': 'itemDetailsPage_addToOrderPopupLabel',
        'lowTasteLabel': 'itemDetailsPage_lowTasteLabel',
        'lowTasteGrid': 'itemDetailsPage_lowTasteGrid',
        'lowTasteCell': 'itemDetailsPage_lowTasteCell',
        'lowTasteButtons': 'itemDetailsPage_lowTasteButtons',
        'notLikeButton': 'itemDetailsPage_notLikeButton',
        'problemButton': 'itemDetailsPage_problemButton',
        'problemInputCell': 'itemDetailsPage_problemInputCell',
        'problemInput': 'itemDetailsPage_problemInput',
        'problemButtonGrid': 'itemDetailsPage_problemButtonGrid',
        'mobilegridcell_104': 'itemDetailsPage_mobilegridcell_104',
        'submitProblemButton': 'itemDetailsPage_submitProblemButton',
        'problemCancelCell': 'itemDetailsPage_problemCancelCell',
        'problemCancelButton': 'itemDetailsPage_problemCancelButton',
        'wishListConfirmPopup': 'itemDetailsPage_wishListConfirmPopup',
        'menuPageItemIsInWishlistLabel': 'itemDetailsPage_menuPageItemIsInWishlistLabel',
        'loginGotoLabel': 'itemDetailsPage_loginGotoLabel',
        'loginGotoButtonGrid': 'itemDetailsPage_loginGotoButtonGrid',
        'loginGotoCell': 'itemDetailsPage_loginGotoCell',
        'loginGotoButton': 'itemDetailsPage_loginGotoButton',
        'loginGotoCancelCell': 'itemDetailsPage_loginGotoCancelCell',
        'loginGotoCancelButton': 'itemDetailsPage_loginGotoCancelButton',
        'swipeLabel': 'itemDetailsPage_swipeLabel',
        'swipeImage': 'itemDetailsPage_swipeImage',
        'termDescription': 'itemDetailsPage_termDescription'
    };
    if ("n2id" in window && window.n2id !== undefined) {
        $.extend(n2id, n2id_buf);
    } else {
        window.n2id = n2id_buf;
    }
    /*
     * Nonvisual components
     */
    Apperyio.mappings = Apperyio.mappings || {};
    Apperyio.mappings["itemDetailsPage_itemDetails_item_read_service_onsuccess_mapping_1"] = {
        "homeScreen": "itemDetailsPage",
        "directions": [
            {
                "from_name": "itemDetails_item_read_service",
                "from_type": "SERVICE_RESPONSE",
                "to_name": "itemDetailsPage",
                "to_type": "UI",
                "mappings": [
                    {
                        "source": "$['body']['description']",
                        "target_transformation": function(value, element) {
                            return value || "";
                        },
                        "target": "$['itemDetailLabelTemp:text']"
                    },
                    {
                        "source": "$['body']['name']",
                        "target": "$['itemLabel:text']"
                    },
                    {
                        "source": "$['body']['price']",
                        "target_transformation": function(value, element) {
                            if (value) {
                                return '$ ' + value.toFixed(2);
                            } else {
                                return "$0.00";
                            }
                        },
                        "target": "$['price:text']"
                    },
                    {
                        "source": "$['body']['hidden']",
                        "target": "$['notAvailableLabel:visible']"
                    },
                    {
                        "source": "$['body']['hidden']",
                        "target_transformation": function(value, element) {
                            return !value;
                        },
                        "target": "$['itemSelectButton:visible']"
                    },
                    {
                        "source": "$['body']['image']['fileName']",
                        "target_transformation": function(value, element) {
                            if (value) {
                                console.log('Showing image from db ' + value);
                                return "https://api.appery.io/rest/1/db/files/" + Settings.database_id + "/" + value;
                            } else {
                                console.log('Showing no image');
                                return NO_IMAGE_URL;
                            }
                        },
                        "target": "$['itemImage:image']"
                    },
                    {
                        "source": "$['body']['vendor_lk']['businessName']",
                        "target": "$['proprietorNameLabel:text']"
                    },
                    {
                        "source": "$['body']['image']['fileName']",
                        "target_transformation": function(value, element) {
                            return value ? true : false;
                        },
                        "target": "$['itemImageGrid:visible']"
                    },
                    {
                        "source": "$['body']['description']",
                        "target_transformation": function(value, element) {
                            return value || "";
                        },
                        "target": "$['itemDetailLabel:rawHtml']"
                    },
                    {
                        "source": "$['body']['image']['fileName']",
                        "target_transformation": function(value, element) {
                            return value ? true : false;
                        },
                        "target": "$['itemImage:visible']"
                    },
                    {
                        "source": "$['body']['price']",
                        "target_transformation": function(value, element) {
                            return value && value > 0;
                        },
                        "target": "$['price:visible']"
                    }
                ]
            },
            {
                "from_name": "itemDetails_item_read_service",
                "from_type": "SERVICE_RESPONSE",
                "to_name": "currentItem",
                "to_type": "SESSION_STORAGE",
                "mappings": [
                    {
                        "source": "$['body']['_id']",
                        "target": "$['id']"
                    },
                    {
                        "source": "$['body']['name']",
                        "target": "$['heading']"
                    },
                    {
                        "source": "$['body']['description']",
                        "target": "$['description']"
                    },
                    {
                        "source": "$['body']['price']",
                        "target": "$['price']"
                    },
                    {
                        "source": "$['body']['hidden']",
                        "target": "$['isHidden']"
                    },
                    {
                        "source": "$['body']['heading']['_id']",
                        "target": "$['parent_id']"
                    }
                ]
            }
        ]
    };
    Apperyio.mappings["itemDetailsPage_itemDetails_item_read_service_onbeforesend_mapping_0"] = {
        "homeScreen": "itemDetailsPage",
        "directions": [
            {
                "from_name": "selectedItem",
                "from_type": "SESSION_STORAGE",
                "to_name": "itemDetails_item_read_service",
                "to_type": "SERVICE_REQUEST",
                "to_default": {
                    "headers": {
                        "X-Appery-Database-Id": "{database_id}"
                    },
                    "parameters": {
                        "include": "vendor_lk,vendor_lk.state,vendor_lk.country,heading,heading.vendor,heading.vendor.state,heading.vendor.country,heading.headingParent"
                    },
                    "body": null
                },
                "mappings": [
                    {
                        "source": "$",
                        "target": "$['parameters']['_id']"
                    }
                ]
            }
        ]
    };
    Apperyio.mappings["itemDetailsPage_itemDetails_favorites_create_service_onbeforesend_mapping_0"] = {
        "homeScreen": "itemDetailsPage",
        "directions": [
            {
                "from_name": "selectedItem",
                "from_type": "SESSION_STORAGE",
                "to_name": "itemDetails_favorites_create_service",
                "to_type": "SERVICE_REQUEST",
                "to_default": {
                    "headers": {
                        "X-Appery-Database-Id": "{database_id}",
                        "X-Appery-Session-Token": "{session_token}",
                        "Content-Type": "application/json"
                    },
                    "parameters": {},
                    "body": {
                        "item": {
                            "collName": "item"
                        },
                        "acl": {
                            "*": {
                                "write": true,
                                "read": true
                            }
                        },
                        "user": {
                            "collName": "_users"
                        }
                    }
                },
                "mappings": [
                    {
                        "source": "$",
                        "target": "$['body']['item']['_id']"
                    }
                ]
            },
            {
                "from_name": "userId",
                "from_type": "LOCAL_STORAGE",
                "to_name": "itemDetails_favorites_create_service",
                "to_type": "SERVICE_REQUEST",
                "to_default": {
                    "headers": {
                        "X-Appery-Database-Id": "{database_id}",
                        "X-Appery-Session-Token": "{session_token}",
                        "Content-Type": "application/json"
                    },
                    "parameters": {},
                    "body": {
                        "item": {
                            "collName": "item"
                        },
                        "acl": {
                            "*": {
                                "write": true,
                                "read": true
                            }
                        },
                        "user": {
                            "collName": "_users"
                        }
                    }
                },
                "mappings": [
                    {
                        "source": "$",
                        "target": "$['body']['user']['_id']"
                    }
                ]
            }
        ]
    };
    Apperyio.mappings["itemDetailsPage_itemDetails_favorites_query_service_onbeforesend_mapping_0"] = {
        "homeScreen": "itemDetailsPage",
        "directions": [
            {
                "from_name": "selectedItem",
                "from_type": "SESSION_STORAGE",
                "to_name": "itemDetails_favorites_query_service",
                "to_type": "SERVICE_REQUEST",
                "to_default": {
                    "headers": {
                        "X-Appery-Database-Id": "{database_id}",
                        "X-Appery-Session-Token": "{session_token}"
                    },
                    "parameters": {
                        "include": "item,item.cuisine_lk,item.ingredientMain_lk,item.ingredientMain_lk.category_lk,item.ingredientHidden_lk,item.ingredientHidden_lk.category_lk,item.ingredientFeatured_lk,item.ingredientFeatured_lk.category_lk,item.rating_lk,item.rating_lk.item,item.rating_lk.item.cuisine_lk,item.rating_lk.item.ingredientMain_lk,item.rating_lk.item.ingredientHidden_lk,item.rating_lk.item.ingredientFeatured_lk,item.rating_lk.item.rating_lk,item.rating_lk.item.vendor_lk,item.rating_lk.item.heading,item.rating_lk.user,item.rating_lk.user.status,item.rating_lk.user.vendor_lk,item.vendor_lk, item.vendor_lk.state,item.vendor_lk.country,item.heading,item.heading.vendor,item.heading.headingParent,item.heading.owner_lk",
                        "limit": "1500"
                    },
                    "body": null
                },
                "mappings": [
                    {
                        "source": "$",
                        "target_transformation": function(value) {
                            return {
                                "item": {
                                    "$inQuery": {
                                        "_id": value
                                    }
                                },
                                "user": {
                                    "$inQuery": {
                                        "_id": storageGet('userId')
                                    }
                                }
                            };
                        },
                        "target": "$['parameters']['where']"
                    }
                ]
            }
        ]
    };
    Apperyio.mappings["itemDetailsPage_itemDetails_rate_read_service_onsuccess_mapping_0"] = {
        "homeScreen": "itemDetailsPage",
        "directions": [
            {
                "from_name": "itemDetails_rate_read_service",
                "from_type": "SERVICE_RESPONSE",
                "to_name": "tempString",
                "to_type": "SESSION_STORAGE",
                "mappings": [
                    {
                        "source": "$['body']['_id']",
                        "target": "$"
                    }
                ]
            }
        ]
    };
    Apperyio.mappings["itemDetailsPage_itemDetails_rate_read_service_onbeforesend_mapping_0"] = {
        "homeScreen": "itemDetailsPage",
        "directions": [
            {
                "from_name": "tempString",
                "from_type": "SESSION_STORAGE",
                "to_name": "itemDetails_rate_read_service",
                "to_type": "SERVICE_REQUEST",
                "to_default": {
                    "headers": {
                        "X-Appery-Database-Id": "{database_id}",
                        "X-Appery-Session-Token": "{session_token}"
                    },
                    "parameters": {
                        "include": "user,user.status,user.vendor_lk,user.vendor_lk.state,user.vendor_lk.country,item,item.cuisine_lk,item.ingredientMain_lk,item.ingredientMain_lk.category_lk,item.ingredientHidden_lk,item.ingredientHidden_lk.category_lk,item.ingredientFeatured_lk,item.ingredientFeatured_lk.category_lk,item.rating_lk,item.rating_lk.item,item.rating_lk.item.cuisine_lk,item.rating_lk.item.ingredientMain_lk,item.rating_lk.item.ingredientHidden_lk,item.rating_lk.item.ingredientFeatured_lk,item.rating_lk.item.rating_lk,item.rating_lk.item.vendor_lk,item.rating_lk.item.heading,item.rating_lk.user,item.vendor_lk,item.vendor_lk.state,item.vendor_lk.country,item.heading"
                    },
                    "body": null
                },
                "mappings": [
                    {
                        "source": "$",
                        "target": "$['parameters']['_id']"
                    }
                ]
            }
        ]
    };
    Apperyio.mappings["itemDetailsPage_itemDetails_rate_create_service_onbeforesend_mapping_0"] = {
        "homeScreen": "itemDetailsPage",
        "directions": [
            {
                "from_name": "userId",
                "from_type": "LOCAL_STORAGE",
                "to_name": "itemDetails_rate_create_service",
                "to_type": "SERVICE_REQUEST",
                "to_default": {
                    "headers": {
                        "X-Appery-Database-Id": "{database_id}",
                        "X-Appery-Session-Token": "{session_token}",
                        "Content-Type": "application/json"
                    },
                    "parameters": {},
                    "body": {
                        "user": {
                            "collName": "_users"
                        },
                        "item": {
                            "collName": "item"
                        },
                        "acl": {
                            "*": {
                                "write": true,
                                "read": true
                            }
                        }
                    }
                },
                "mappings": [
                    {
                        "source": "$",
                        "target": "$['body']['user']['_id']"
                    }
                ]
            },
            {
                "from_name": "selectedItem",
                "from_type": "SESSION_STORAGE",
                "to_name": "itemDetails_rate_create_service",
                "to_type": "SERVICE_REQUEST",
                "to_default": {
                    "headers": {
                        "X-Appery-Database-Id": "{database_id}",
                        "X-Appery-Session-Token": "{session_token}",
                        "Content-Type": "application/json"
                    },
                    "parameters": {},
                    "body": {
                        "user": {
                            "collName": "_users"
                        },
                        "item": {
                            "collName": "item"
                        },
                        "acl": {
                            "*": {
                                "write": true,
                                "read": true
                            }
                        }
                    }
                },
                "mappings": [
                    {
                        "source": "$",
                        "target": "$['body']['item']['_id']"
                    }
                ]
            },
            {
                "from_name": "tempNumber",
                "from_type": "SESSION_STORAGE",
                "to_name": "itemDetails_rate_create_service",
                "to_type": "SERVICE_REQUEST",
                "to_default": {
                    "headers": {
                        "X-Appery-Database-Id": "{database_id}",
                        "X-Appery-Session-Token": "{session_token}",
                        "Content-Type": "application/json"
                    },
                    "parameters": {},
                    "body": {
                        "user": {
                            "collName": "_users"
                        },
                        "item": {
                            "collName": "item"
                        },
                        "acl": {
                            "*": {
                                "write": true,
                                "read": true
                            }
                        }
                    }
                },
                "mappings": [
                    {
                        "source": "$",
                        "target": "$['body']['taste']"
                    }
                ]
            },
            {
                "from_name": "itemDetailsPage",
                "from_type": "UI",
                "to_name": "itemDetails_rate_create_service",
                "to_type": "SERVICE_REQUEST",
                "to_default": {
                    "headers": {
                        "X-Appery-Database-Id": "{database_id}",
                        "X-Appery-Session-Token": "{session_token}",
                        "Content-Type": "application/json"
                    },
                    "parameters": {},
                    "body": {
                        "user": {
                            "collName": "_users"
                        },
                        "item": {
                            "collName": "item"
                        },
                        "acl": {
                            "*": {
                                "write": true,
                                "read": true
                            }
                        }
                    }
                },
                "mappings": [
                    {
                        "source": "$['problemInput:text']",
                        "target": "$['body']['problemDescription']"
                    }
                ]
            }
        ]
    };
    Apperyio.mappings["itemDetailsPage_itemDetails_rate_update_service_onbeforesend_mapping_0"] = {
        "homeScreen": "itemDetailsPage",
        "directions": [
            {
                "from_name": "tempNumber",
                "from_type": "SESSION_STORAGE",
                "to_name": "itemDetails_rate_update_service",
                "to_type": "SERVICE_REQUEST",
                "to_default": {
                    "headers": {
                        "X-Appery-Database-Id": "{database_id}",
                        "X-Appery-Session-Token": "{session_token}",
                        "Content-Type": "application/json"
                    },
                    "parameters": {},
                    "body": {
                        "acl": {
                            "*": {
                                "write": true,
                                "read": true
                            }
                        }
                    }
                },
                "mappings": [
                    {
                        "source": "$",
                        "target": "$['body']['taste']"
                    }
                ]
            },
            {
                "from_name": "tempString",
                "from_type": "SESSION_STORAGE",
                "to_name": "itemDetails_rate_update_service",
                "to_type": "SERVICE_REQUEST",
                "to_default": {
                    "headers": {
                        "X-Appery-Database-Id": "{database_id}",
                        "X-Appery-Session-Token": "{session_token}",
                        "Content-Type": "application/json"
                    },
                    "parameters": {},
                    "body": {
                        "acl": {
                            "*": {
                                "write": true,
                                "read": true
                            }
                        }
                    }
                },
                "mappings": [
                    {
                        "source": "$",
                        "target": "$['parameters']['_id']"
                    }
                ]
            },
            {
                "from_name": "itemDetailsPage",
                "from_type": "UI",
                "to_name": "itemDetails_rate_update_service",
                "to_type": "SERVICE_REQUEST",
                "to_default": {
                    "headers": {
                        "X-Appery-Database-Id": "{database_id}",
                        "X-Appery-Session-Token": "{session_token}",
                        "Content-Type": "application/json"
                    },
                    "parameters": {},
                    "body": {
                        "acl": {
                            "*": {
                                "write": true,
                                "read": true
                            }
                        }
                    }
                },
                "mappings": [
                    {
                        "source": "$['problemInput:text']",
                        "target": "$['body']['problemDescription']"
                    }
                ]
            }
        ]
    };
    Apperyio.mappings["itemDetailsPage_itemDetails_gatRate_service_onsuccess_mapping_1"] = {
        "homeScreen": "itemDetailsPage",
        "directions": [
            {
                "from_name": "itemDetails_gatRate_service",
                "from_type": "SERVICE_RESPONSE",
                "to_name": "itemDetailsPage",
                "to_type": "UI",
                "mappings": [
                    {
                        "source": "$['body']['plus2Count']",
                        "target_transformation": function(value, element) {
                            return value || "";
                        },
                        "target": "$['plus2CountLabel:text']"
                    },
                    {
                        "source": "$['body']['plus1Count']",
                        "target_transformation": function(value, element) {
                            return value || "";
                        },
                        "target": "$['plus1CountLabel:text']"
                    },
                    {
                        "source": "$['body']['plus2Persent']",
                        "target_transformation": function(value, element) {
                            if (value) {
                                return value.toFixed(0);
                            } else {
                                return "";
                            }
                        },
                        "target": "$['plus2PercentLabel:text']"
                    },
                    {
                        "source": "$['body']['plus1Persent']",
                        "target_transformation": function(value, element) {
                            if (value) {
                                return value.toFixed(0);
                            } else {
                                return "";
                            }
                        },
                        "target": "$['plus1PercentLabel:text']"
                    }
                ]
            }
        ]
    };
    Apperyio.mappings["itemDetailsPage_itemDetails_gatRate_service_onbeforesend_mapping_0"] = {
        "homeScreen": "itemDetailsPage",
        "directions": [
            {
                "from_name": "selectedItem",
                "from_type": "SESSION_STORAGE",
                "to_name": "itemDetails_gatRate_service",
                "to_type": "SERVICE_REQUEST",
                "to_default": {
                    "headers": {},
                    "parameters": {
                        "itemId": "5694fa61e4b0ecf32b694187"
                    },
                    "body": null
                },
                "mappings": [
                    {
                        "source": "$",
                        "target": "$['parameters']['itemId']"
                    }
                ]
            }
        ]
    };
    Apperyio.mappings["itemDetailsPage_itemDetails_rate_query_service_onbeforesend_mapping_0"] = {
        "homeScreen": "itemDetailsPage",
        "directions": [
            {
                "to_name": "itemDetails_rate_query_service",
                "to_type": "SERVICE_REQUEST",
                "to_default": {
                    "headers": {
                        "X-Appery-Database-Id": "{database_id}",
                        "X-Appery-Session-Token": "{session_token}"
                    },
                    "parameters": {
                        "include": "user,user.status,user.vendor_lk,user.vendor_lk.state,user.vendor_lk.country,item,item.cuisine_lk,item.ingredientMain_lk,item.ingredientMain_lk.category_lk,item.ingredientHidden_lk,item.ingredientHidden_lk.category_lk,item.ingredientFeatured_lk,item.ingredientFeatured_lk.category_lk,item.rating_lk,item.rating_lk.item,item.rating_lk.item.cuisine_lk,item.rating_lk.item.ingredientMain_lk,item.rating_lk.item.ingredientHidden_lk,item.rating_lk.item.ingredientFeatured_lk,item.rating_lk.item.rating_lk,item.rating_lk.item.vendor_lk,item.rating_lk.item.heading,item.rating_lk.user,item.vendor_lk,item.vendor_lk.state,item.vendor_lk.country,item.heading"
                    },
                    "body": null
                },
                "mappings": [
                    {
                        "target_transformation": function(value) {
                            return {
                                "user": {
                                    "$inQuery": {
                                        "_id": storageGet('userId')
                                    }
                                },
                                "item": {
                                    "$inQuery": {
                                        "_id": storageGet('selectedItem')
                                    }
                                }
                            };
                        },
                        "target": "$['parameters']['where']"
                    }
                ]
            }
        ]
    };
    Apperyio.mappings["itemDetailsPage_itemDetails_orderItem_create_service_onbeforesend_mapping_0"] = {
        "homeScreen": "itemDetailsPage",
        "directions": [
            {
                "from_name": "selectedItem",
                "from_type": "SESSION_STORAGE",
                "to_name": "itemDetails_orderItem_create_service",
                "to_type": "SERVICE_REQUEST",
                "to_default": {
                    "headers": {
                        "X-Appery-Database-Id": "{database_id}",
                        "X-Appery-Session-Token": "{session_token}",
                        "Content-Type": "application/json"
                    },
                    "parameters": {},
                    "body": {
                        "quantity": 1,
                        "item": {
                            "collName": "item"
                        },
                        "acl": {
                            "*": {
                                "write": true,
                                "read": true
                            }
                        },
                        "user": {
                            "callName": "_users"
                        }
                    }
                },
                "mappings": [
                    {
                        "source": "$",
                        "target": "$['body']['item']['_id']"
                    }
                ]
            },
            {
                "from_name": "userId",
                "from_type": "LOCAL_STORAGE",
                "to_name": "itemDetails_orderItem_create_service",
                "to_type": "SERVICE_REQUEST",
                "to_default": {
                    "headers": {
                        "X-Appery-Database-Id": "{database_id}",
                        "X-Appery-Session-Token": "{session_token}",
                        "Content-Type": "application/json"
                    },
                    "parameters": {},
                    "body": {
                        "quantity": 1,
                        "item": {
                            "collName": "item"
                        },
                        "acl": {
                            "*": {
                                "write": true,
                                "read": true
                            }
                        },
                        "user": {
                            "callName": "_users"
                        }
                    }
                },
                "mappings": [
                    {
                        "source": "$",
                        "target": "$['body']['user']['_id']"
                    }
                ]
            }
        ]
    };
    Apperyio.mappings["itemDetailsPage_itemDetails_wishlist_create_service_onbeforesend_mapping_0"] = {
        "homeScreen": "itemDetailsPage",
        "directions": [
            {
                "from_name": "selectedItem",
                "from_type": "SESSION_STORAGE",
                "to_name": "itemDetails_wishlist_create_service",
                "to_type": "SERVICE_REQUEST",
                "to_default": {
                    "headers": {
                        "X-Appery-Database-Id": "{database_id}",
                        "X-Appery-Session-Token": "{session_token}",
                        "Content-Type": "application/json"
                    },
                    "parameters": {},
                    "body": {
                        "item": {
                            "collName": "item"
                        },
                        "acl": {
                            "*": {
                                "write": true,
                                "read": true
                            }
                        },
                        "user": {
                            "collName": "_users"
                        }
                    }
                },
                "mappings": [
                    {
                        "source": "$",
                        "target": "$['body']['item']['_id']"
                    }
                ]
            },
            {
                "from_name": "itemDetailsPage",
                "from_type": "UI",
                "to_name": "itemDetails_wishlist_create_service",
                "to_type": "SERVICE_REQUEST",
                "to_default": {
                    "headers": {
                        "X-Appery-Database-Id": "{database_id}",
                        "X-Appery-Session-Token": "{session_token}",
                        "Content-Type": "application/json"
                    },
                    "parameters": {},
                    "body": {
                        "item": {
                            "collName": "item"
                        },
                        "acl": {
                            "*": {
                                "write": true,
                                "read": true
                            }
                        },
                        "user": {
                            "collName": "_users"
                        }
                    }
                },
                "mappings": [
                    {
                        "source": "$['wishListNote:text']",
                        "target": "$['body']['notes']"
                    }
                ]
            },
            {
                "from_name": "userId",
                "from_type": "LOCAL_STORAGE",
                "to_name": "itemDetails_wishlist_create_service",
                "to_type": "SERVICE_REQUEST",
                "to_default": {
                    "headers": {
                        "X-Appery-Database-Id": "{database_id}",
                        "X-Appery-Session-Token": "{session_token}",
                        "Content-Type": "application/json"
                    },
                    "parameters": {},
                    "body": {
                        "item": {
                            "collName": "item"
                        },
                        "acl": {
                            "*": {
                                "write": true,
                                "read": true
                            }
                        },
                        "user": {
                            "collName": "_users"
                        }
                    }
                },
                "mappings": [
                    {
                        "source": "$",
                        "target": "$['body']['user']['_id']"
                    }
                ]
            }
        ]
    };
    Apperyio.mappings["itemDetailsPage_itemDetails_wishlist_query_service_onbeforesend_mapping_0"] = {
        "homeScreen": "itemDetailsPage",
        "directions": [
            {
                "from_name": "selectedItem",
                "from_type": "SESSION_STORAGE",
                "to_name": "itemDetails_wishlist_query_service",
                "to_type": "SERVICE_REQUEST",
                "to_default": {
                    "headers": {
                        "X-Appery-Database-Id": "{database_id}",
                        "X-Appery-Session-Token": "{session_token}"
                    },
                    "parameters": {
                        "include": "item,item.cuisine_lk,item.ingredientMain_lk,item.ingredientMain_lk.category_lk,item.ingredientHidden_lk,item.ingredientHidden_lk.category_lk,item.ingredientFeatured_lk,item.ingredientFeatured_lk.category_lk,item.rating_lk,item.rating_lk.item,item.rating_lk.item.cuisine_lk,item.rating_lk.item.ingredientMain_lk,item.rating_lk.item.ingredientHidden_lk,item.rating_lk.item.ingredientFeatured_lk,item.rating_lk.item.rating_lk,item.rating_lk.item.vendor_lk,item.rating_lk.item.heading,item.rating_lk.user,item.rating_lk.user.status,item.rating_lk.user.vendor_lk,item.vendor_lk,item.vendor_lk.state,item.vendor_lk.country,item.heading,item.heading.vendor,item.heading.headingParent,item.heading.owner_lk",
                        "limit": "1500"
                    },
                    "body": null
                },
                "mappings": [
                    {
                        "source": "$",
                        "target_transformation": function(value) {
                            return {
                                "item": {
                                    "$inQuery": {
                                        "_id": value
                                    }
                                },
                                "user": {
                                    "$inQuery": {
                                        "_id": storageGet('userId')
                                    }
                                }
                            };
                        },
                        "target": "$['parameters']['where']"
                    }
                ]
            }
        ]
    };
    Apperyio.mappings["itemDetailsPage_itemDetails_logout_service_onbeforesend_mapping_0"] = {
        "homeScreen": "itemDetailsPage",
        "directions": [
            {
                "to_name": "itemDetails_logout_service",
                "to_type": "SERVICE_REQUEST",
                "to_default": {
                    "headers": {
                        "X-Appery-Database-Id": "{database_id}",
                        "X-Appery-Session-Token": "{session_token}"
                    },
                    "parameters": {},
                    "body": null
                },
                "mappings": []
            }
        ]
    };
    Apperyio.mappings["itemDetailsPage_itemDetails_createSelected_service_onsuccess_mapping_0"] = {
        "homeScreen": "itemDetailsPage",
        "directions": []
    };
    Apperyio.mappings["itemDetailsPage_itemDetails_createSelected_service_onbeforesend_mapping_0"] = {
        "homeScreen": "itemDetailsPage",
        "directions": [
            {
                "from_name": "sessionToken",
                "from_type": "SESSION_STORAGE",
                "to_name": "itemDetails_createSelected_service",
                "to_type": "SERVICE_REQUEST",
                "to_default": {
                    "headers": {
                        "X-Appery-Database-Id": "{database_id}",
                        "Content-Type": "application/json"
                    },
                    "parameters": {},
                    "body": {
                        "itemID": {
                            "collName": "item"
                        },
                        "current": true,
                        "acl": {
                            "*": {
                                "write": true,
                                "read": true
                            }
                        },
                        "userID": {
                            "collName": "_users"
                        },
                        "vendor_lk": {
                            "collName": "vendor"
                        },
                        "fromPage": "itemDetailsPage"
                    }
                },
                "mappings": [
                    {
                        "source": "$",
                        "target": "$['headers']['X-Appery-Session-Token']"
                    }
                ]
            },
            {
                "from_name": "currentItem",
                "from_type": "SESSION_STORAGE",
                "to_name": "itemDetails_createSelected_service",
                "to_type": "SERVICE_REQUEST",
                "to_default": {
                    "headers": {
                        "X-Appery-Database-Id": "{database_id}",
                        "Content-Type": "application/json"
                    },
                    "parameters": {},
                    "body": {
                        "itemID": {
                            "collName": "item"
                        },
                        "current": true,
                        "acl": {
                            "*": {
                                "write": true,
                                "read": true
                            }
                        },
                        "userID": {
                            "collName": "_users"
                        },
                        "vendor_lk": {
                            "collName": "vendor"
                        },
                        "fromPage": "itemDetailsPage"
                    }
                },
                "mappings": [
                    {
                        "source": "$['id']",
                        "target": "$['body']['itemID']['_id']"
                    },
                    {
                        "source": "$['heading']",
                        "target": "$['body']['itemName']"
                    }
                ]
            },
            {
                "from_name": "currentVendor",
                "from_type": "SESSION_STORAGE",
                "to_name": "itemDetails_createSelected_service",
                "to_type": "SERVICE_REQUEST",
                "to_default": {
                    "headers": {
                        "X-Appery-Database-Id": "{database_id}",
                        "Content-Type": "application/json"
                    },
                    "parameters": {},
                    "body": {
                        "itemID": {
                            "collName": "item"
                        },
                        "current": true,
                        "acl": {
                            "*": {
                                "write": true,
                                "read": true
                            }
                        },
                        "userID": {
                            "collName": "_users"
                        },
                        "vendor_lk": {
                            "collName": "vendor"
                        },
                        "fromPage": "itemDetailsPage"
                    }
                },
                "mappings": [
                    {
                        "source": "$['id']",
                        "target": "$['body']['vendor_lk']['_id']"
                    }
                ]
            },
            {
                "from_name": "userId",
                "from_type": "LOCAL_STORAGE",
                "to_name": "itemDetails_createSelected_service",
                "to_type": "SERVICE_REQUEST",
                "to_default": {
                    "headers": {
                        "X-Appery-Database-Id": "{database_id}",
                        "Content-Type": "application/json"
                    },
                    "parameters": {},
                    "body": {
                        "itemID": {
                            "collName": "item"
                        },
                        "current": true,
                        "acl": {
                            "*": {
                                "write": true,
                                "read": true
                            }
                        },
                        "userID": {
                            "collName": "_users"
                        },
                        "vendor_lk": {
                            "collName": "vendor"
                        },
                        "fromPage": "itemDetailsPage"
                    }
                },
                "mappings": [
                    {
                        "source": "$",
                        "target": "$['body']['userID']['_id']"
                    }
                ]
            }
        ]
    };
    Apperyio.mappings["itemDetailsPage_itemDetails_getPairedItems_service_onsuccess_mapping_0"] = {
        "homeScreen": "itemDetailsPage",
        "directions": [
            {
                "from_name": "itemDetails_getPairedItems_service",
                "from_type": "SERVICE_RESPONSE",
                "to_name": "itemDetailsPage",
                "to_type": "UI",
                "mappings": [
                    {
                        "source": "$['body']['found']",
                        "target": "$['pairingGrid:visible']"
                    },
                    {
                        "source": "$['body']['data'][i]",
                        "target": "$['mobilecollapsblock_99']"
                    },
                    {
                        "source": "$['body']['data'][i]['heading']",
                        "target": "$['mobilecollapsblock_99']['mobilecollapsblockheader_100:text']"
                    },
                    {
                        "source": "$['body']['data'][i]['items'][i]",
                        "target_transformation": function(value, element) {
                            $(element).attr('item_id', value._id);
                        },
                        "target": "$['mobilecollapsblock_99']['pairingItem']"
                    },
                    {
                        "source": "$['body']['data'][i]['items'][i]['name']",
                        "target": "$['mobilecollapsblock_99']['pairingItem']['itemName:text']"
                    },
                    {
                        "source": "$['body']['data'][i]['items'][i]['price']",
                        "target_transformation": function(value, element) {
                            if (value) {
                                return '$ ' + value.toFixed(2);
                            } else {
                                return "";
                            }
                        },
                        "target": "$['mobilecollapsblock_99']['pairingItem']['itemPrice:text']"
                    }
                ]
            }
        ]
    };
    Apperyio.mappings["itemDetailsPage_itemDetails_getPairedItems_service_onbeforesend_mapping_0"] = {
        "homeScreen": "itemDetailsPage",
        "directions": [
            {
                "from_name": "sessionToken",
                "from_type": "SESSION_STORAGE",
                "to_name": "itemDetails_getPairedItems_service",
                "to_type": "SERVICE_REQUEST",
                "to_default": {
                    "headers": {},
                    "parameters": {},
                    "body": null
                },
                "mappings": [
                    {
                        "source": "$",
                        "target": "$['headers']['X-Appery-Session-Token']"
                    }
                ]
            },
            {
                "from_name": "currentItem",
                "from_type": "SESSION_STORAGE",
                "to_name": "itemDetails_getPairedItems_service",
                "to_type": "SERVICE_REQUEST",
                "to_default": {
                    "headers": {},
                    "parameters": {},
                    "body": null
                },
                "mappings": [
                    {
                        "source": "$['id']",
                        "target": "$['parameters']['item_id']"
                    }
                ]
            }
        ]
    };
    Apperyio.datasources = Apperyio.datasources || {};
    window.itemDetails_item_read_service = Apperyio.datasources.itemDetails_item_read_service = new Apperyio.DataSource(projectMdb1_item_read_service, {
        "onBeforeSend": function(jqXHR) {
            Apperyio.processMappingAction(Apperyio.mappings["itemDetailsPage_itemDetails_item_read_service_onbeforesend_mapping_0"]);
        },
        "onComplete": function(jqXHR, textStatus) {
            bindTermLink();
        },
        "onSuccess": function(data) {
            if (data.parsedDescription) {
                data.description = data.parsedDescription;
            }
            if (data.includePrefs && data.includePrefs.length > 0) {
                Apperyio('itemPrefs').show().html(data.includePrefs.join(', '));
            } else {
                Apperyio('itemPrefs').hide();
            };
            Apperyio.processMappingAction(Apperyio.mappings["itemDetailsPage_itemDetails_item_read_service_onsuccess_mapping_1"]);
            try {
                itemDetails_gatRate_service.execute({});
            } catch (e) {
                console.error(e);
                hideSpinner();
            };
            try {
                itemDetails_getPairedItems_service.execute({});
            } catch (e) {
                console.error(e);
                hideSpinner();
            };
        },
        "onError": function(jqXHR, textStatus, errorThrown) {}
    });
    window.itemDetails_favorites_create_service = Apperyio.datasources.itemDetails_favorites_create_service = new Apperyio.DataSource(projectMdb1_favorites_create_service, {
        "onBeforeSend": function(jqXHR) {
            Apperyio.processMappingAction(Apperyio.mappings["itemDetailsPage_itemDetails_favorites_create_service_onbeforesend_mapping_0"]);
        },
        "onComplete": function(jqXHR, textStatus) {
        },
        "onSuccess": function(data) {
            showPopupWithTimout('favoriteConfirmPopup', favoriteConfirmPopupTime);
            var item = storageGet('selectedItem');
            var menuData = storageGet('menuHierarchyList');
            if (menuData) {
                var i = menuData.findIndex(function(x){return x._id == item;});
                if (i > -1) {
                    menuData[i].favorite = true;
                    storageSet('menuHierarchyList', menuData);
                }
            }
            // storageSet('lastSelectedMenuItem', 'heart_' + item);
            //setTimeout(function(){
            //	Apperyio('favoriteConfirmPopup').popup('close');
            //}, favoriteConfirmPopupTime);
        },
        "onError": function(jqXHR, textStatus, errorThrown) {}
    });
    window.itemDetails_favorites_query_service = Apperyio.datasources.itemDetails_favorites_query_service = new Apperyio.DataSource(projectMdb1_favorites_query_service, {
        "onBeforeSend": function(jqXHR) {
            Apperyio.processMappingAction(Apperyio.mappings["itemDetailsPage_itemDetails_favorites_query_service_onbeforesend_mapping_0"]);
        },
        "onComplete": function(jqXHR, textStatus) {
        },
        "onSuccess": function(data) {
            if (!data.length) {
                itemDetails_favorites_create_service.execute({});
            } else {
                log('sdsdsd');
                showPopupWithTimout('favoriveExistsPopup', favoriveExistsPopupTime);
            };
        },
        "onError": function(jqXHR, textStatus, errorThrown) {}
    });
    window.itemDetails_rate_read_service = Apperyio.datasources.itemDetails_rate_read_service = new Apperyio.DataSource(projectMdb1_rate_read_service, {
        "onBeforeSend": function(jqXHR) {
            Apperyio.processMappingAction(Apperyio.mappings["itemDetailsPage_itemDetails_rate_read_service_onbeforesend_mapping_0"]);
        },
        "onComplete": function(jqXHR, textStatus) {
        },
        "onSuccess": function(data) {
            Apperyio.processMappingAction(Apperyio.mappings["itemDetailsPage_itemDetails_rate_read_service_onsuccess_mapping_0"]);
            try {
                itemDetails_rate_update_service.execute({});
            } catch (e) {
                console.error(e);
                hideSpinner();
            };
        },
        "onError": function(jqXHR, textStatus, errorThrown) {
            try {
                itemDetails_rate_create_service.execute({});
            } catch (e) {
                console.error(e);
                hideSpinner();
            };
        }
    });
    window.itemDetails_rate_create_service = Apperyio.datasources.itemDetails_rate_create_service = new Apperyio.DataSource(projectMdb1_rate_create_service, {
        "onBeforeSend": function(jqXHR) {
            Apperyio.processMappingAction(Apperyio.mappings["itemDetailsPage_itemDetails_rate_create_service_onbeforesend_mapping_0"]);
        },
        "onComplete": function(jqXHR, textStatus) {
        },
        "onSuccess": function(data) {
            try {
                itemDetails_gatRate_service.execute({});
            } catch (e) {
                console.error(e);
                hideSpinner();
            };
        },
        "onError": function(jqXHR, textStatus, errorThrown) {}
    });
    window.itemDetails_rate_update_service = Apperyio.datasources.itemDetails_rate_update_service = new Apperyio.DataSource(projectMdb1_rate_update_service, {
        "onBeforeSend": function(jqXHR) {
            Apperyio.processMappingAction(Apperyio.mappings["itemDetailsPage_itemDetails_rate_update_service_onbeforesend_mapping_0"]);
        },
        "onComplete": function(jqXHR, textStatus) {
        },
        "onSuccess": function(data) {
            try {
                itemDetails_gatRate_service.execute({});
            } catch (e) {
                console.error(e);
                hideSpinner();
            };
        },
        "onError": function(jqXHR, textStatus, errorThrown) {}
    });
    window.itemDetails_gatRate_service = Apperyio.datasources.itemDetails_gatRate_service = new Apperyio.DataSource(gatRate_service, {
        "onBeforeSend": function(jqXHR) {
            Apperyio.processMappingAction(Apperyio.mappings["itemDetailsPage_itemDetails_gatRate_service_onbeforesend_mapping_0"]);
        },
        "onComplete": function(jqXHR, textStatus) {
        },
        "onSuccess": function(data) {
            Apperyio.processMappingAction(Apperyio.mappings["itemDetailsPage_itemDetails_gatRate_service_onsuccess_mapping_1"]);
        },
        "onError": function(jqXHR, textStatus, errorThrown) {}
    });
    window.itemDetails_rate_query_service = Apperyio.datasources.itemDetails_rate_query_service = new Apperyio.DataSource(projectMdb1_rate_query_service, {
        "onBeforeSend": function(jqXHR) {
            Apperyio.processMappingAction(Apperyio.mappings["itemDetailsPage_itemDetails_rate_query_service_onbeforesend_mapping_0"]);
        },
        "onComplete": function(jqXHR, textStatus) {
        },
        "onSuccess": function(data) {
            if (data.length) {
                storageSet('tempString', data[0]._id);
                itemDetails_rate_update_service.execute({});
            } else {
                storageSet('tempString', null);
                itemDetails_rate_create_service.execute({});
            };
        },
        "onError": function(jqXHR, textStatus, errorThrown) {
            storageSet('tempString', null);
            itemDetails_rate_create_service.execute({});
        }
    });
    window.itemDetails_orderItem_create_service = Apperyio.datasources.itemDetails_orderItem_create_service = new Apperyio.DataSource(projectMdb1_orderItem_create_service, {
        "onBeforeSend": function(jqXHR) {
            Apperyio.processMappingAction(Apperyio.mappings["itemDetailsPage_itemDetails_orderItem_create_service_onbeforesend_mapping_0"]);
        },
        "onComplete": function(jqXHR, textStatus) {
        },
        "onSuccess": function(data) {
            showPopupWithTimout('addToOrderPopup', addToOrderPopupTime);
        },
        "onError": function(jqXHR, textStatus, errorThrown) {}
    });
    window.itemDetails_wishlist_create_service = Apperyio.datasources.itemDetails_wishlist_create_service = new Apperyio.DataSource(projectMdb1_wishlist_create_service, {
        "onBeforeSend": function(jqXHR) {
            Apperyio.processMappingAction(Apperyio.mappings["itemDetailsPage_itemDetails_wishlist_create_service_onbeforesend_mapping_0"]);
        },
        "onComplete": function(jqXHR, textStatus) {
        },
        "onSuccess": function(data) {
            showPopupWithTimout('wishlistConfirmPopup', wishlistConfirmPopupTime);
        },
        "onError": function(jqXHR, textStatus, errorThrown) {}
    });
    window.itemDetails_wishlist_query_service = Apperyio.datasources.itemDetails_wishlist_query_service = new Apperyio.DataSource(projectMdb1_wishlist_query_service, {
        "onBeforeSend": function(jqXHR) {
            Apperyio.processMappingAction(Apperyio.mappings["itemDetailsPage_itemDetails_wishlist_query_service_onbeforesend_mapping_0"]);
        },
        "onComplete": function(jqXHR, textStatus) {
        },
        "onSuccess": function(data) {
            if (!data.length) {
                Apperyio('wishListPopup').popup('open');
                var item = storageGet('selectedItem');
                var menuData = storageGet('menuHierarchyList');
                if (menuData) {
                    var i = menuData.findIndex(function(x){return x._id == item;});
                    if (i > -1) {
                        menuData[i].wishlist = true;
                         storageSet('menuHierarchyList', menuData);
                    }
                }
                // storageSet('lastSelectedMenuItem', 'wishlist_' + item);
            } else {
                showPopupWithTimout('wishlistContainsItem', wishlistContainsItemTime);
            };
        },
        "onError": function(jqXHR, textStatus, errorThrown) {}
    });
    window.itemDetails_logout_service = Apperyio.datasources.itemDetails_logout_service = new Apperyio.DataSource(projectMdb1_logout_service, {
        "onBeforeSend": function(jqXHR) {
            Apperyio.processMappingAction(Apperyio.mappings["itemDetailsPage_itemDetails_logout_service_onbeforesend_mapping_0"]);
        },
        "onComplete": function(jqXHR, textStatus) {
        },
        "onSuccess": function(data) {
            Apperyio.navigateTo('startScreen', {
                transition: 'slide',
                reverse: false
            });
        },
        "onError": function(jqXHR, textStatus, errorThrown) {}
    });
    window.itemDetails_createSelected_service = Apperyio.datasources.itemDetails_createSelected_service = new Apperyio.DataSource(projectMdb1_selected_create_service, {
        "onBeforeSend": function(jqXHR) {
            Apperyio.processMappingAction(Apperyio.mappings["itemDetailsPage_itemDetails_createSelected_service_onbeforesend_mapping_0"]);
        },
        "onComplete": function(jqXHR, textStatus) {
        },
        "onSuccess": function(data) {
            Apperyio.processMappingAction(Apperyio.mappings["itemDetailsPage_itemDetails_createSelected_service_onsuccess_mapping_0"]);
        },
        "onError": function(jqXHR, textStatus, errorThrown) {}
    });
    window.itemDetails_getPairedItems_service = Apperyio.datasources.itemDetails_getPairedItems_service = new Apperyio.DataSource(getPairedItems_service, {
        "onBeforeSend": function(jqXHR) {
            Apperyio.processMappingAction(Apperyio.mappings["itemDetailsPage_itemDetails_getPairedItems_service_onbeforesend_mapping_0"]);
        },
        "onComplete": function(jqXHR, textStatus) {
        },
        "onSuccess": function(data) {
            Apperyio.processMappingAction(Apperyio.mappings["itemDetailsPage_itemDetails_getPairedItems_service_onsuccess_mapping_0"]);
        },
        "onError": function(jqXHR, textStatus, errorThrown) {}
    });
    Apperyio.CurrentScreen = 'itemDetailsPage';
    _.chain(Apperyio.mappings)
        .filter(function(m) {
            return m.homeScreen === Apperyio.CurrentScreen;
        })
        .each(Apperyio.UIHandler.hideTemplateComponents);
    /*
     * Events and handlers
     */
    // On Load
    var itemDetailsPage_onLoad = function() {
        itemDetailsPage_elementsExtraJS();
        itemDetailsPage_deviceEvents();
        itemDetailsPage_windowEvents();
        itemDetailsPage_elementsEvents();
    };
    // screen window events
    function itemDetailsPage_windowEvents() {
        $('#itemDetailsPage').bind('pageshow orientationchange', function() {
            var _page = this;
            adjustContentHeightWithPadding(_page);
        });
        $('#itemDetailsPage').on({
            swipeleft: function(event) { //alert(getPrevMenuItemId(storageGet('selectedItem')));
                storageSet('selectedItem', getNextMenuItemId(storageGet('selectedItem')));
                //Apperyio.navigateTo('itemDetailsPage', {transition: 'slide', reloadPage: true});
                //alert('swipe left');
                try {
                    itemDetails_item_read_service.execute({});
                } catch (e) {
                    console.error(e);
                    hideSpinner();
                };
            },
            pageshow: function(event) {
                try {
                    itemDetails_item_read_service.execute({});
                } catch (e) {
                    console.error(e);
                    hideSpinner();
                };
            },
            swiperight: function(event) { //alert(getPrevMenuItemId(storageGet('selectedItem')));
                storageSet('selectedItem', getPrevMenuItemId(storageGet('selectedItem')));
                //Apperyio.navigateTo('itemDetailsPage', {transition: 'slide', reloadPage: true});
                //alert('swipr right');
                try {
                    itemDetails_item_read_service.execute({});
                } catch (e) {
                    console.error(e);
                    hideSpinner();
                };
            },
        });
    };
    // device events
    function itemDetailsPage_deviceEvents() {
        document.addEventListener("deviceready", function() {
        });
    };
    // screen elements extra js
    function itemDetailsPage_elementsExtraJS() {
        // screen (itemDetailsPage) extra code
        /* mobilecollapsblock_99 */
        $("#itemDetailsPage_mobilecollapsblock_99 .ui-collapsible-heading-toggle").attr("tabindex", "31");
        /* pairingList */
        listView = $("#itemDetailsPage_pairingList");
        theme = listView.attr("data-theme");
        if (typeof theme !== 'undefined') {
            var themeClass = "ui-btn-up-" + theme;
            listItem = $("#itemDetailsPage_pairingList .ui-li-static");
            $.each(listItem, function(index, value) {
                $(this).addClass(themeClass);
            });
        }
        /* pairingItem */
        /* ratingChoicesPopup */
        $("#itemDetailsPage_ratingChoicesPopup").popup("option", "positionTo", "window");
        /* wishListPopup */
        $("#itemDetailsPage_wishListPopup").popup("option", "positionTo", "window");
        /* favoriteConfirmPopup */
        $("#itemDetailsPage_favoriteConfirmPopup").popup("option", "positionTo", "window");
        /* favoriveExistsPopup */
        $("#itemDetailsPage_favoriveExistsPopup").popup("option", "positionTo", "window");
        /* wishlistContainsItem */
        $("#itemDetailsPage_wishlistContainsItem").popup("option", "positionTo", "window");
        /* addToOrderPopup */
        $("#itemDetailsPage_addToOrderPopup").popup("option", "positionTo", "window");
        /* lowTastePopup */
        $("#itemDetailsPage_lowTastePopup").popup("option", "positionTo", "window");
        /* wishlistConfirmPopup */
        $("#itemDetailsPage_wishlistConfirmPopup").popup("option", "positionTo", "window");
        /* menuPageItemIsInWishlistPopup */
        $("#itemDetailsPage_menuPageItemIsInWishlistPopup").popup("option", "positionTo", "window");
        /* loginGotoPopup */
        $("#itemDetailsPage_loginGotoPopup").popup("option", "positionTo", "window");
        /* swipePopup */
        $("#itemDetailsPage_swipePopup").popup("option", "positionTo", "window");
        /* termPopup */
        $("#itemDetailsPage_termPopup").popup("option", "positionTo", "[name=itemDetailLabel]");
    };
    // screen elements handler
    function itemDetailsPage_elementsEvents() {
        $(document).on("click", "a :input,a a,a fieldset label", function(event) {
            event.stopPropagation();
        });
        $(document).off("click", '#itemDetailsPage_itemDetailsHeader [name="navigateButton"]').on({
            click: function(event) {
                if (!$(this).attr('disabled')) {
                    navigateRB();
                }
            },
        }, '#itemDetailsPage_itemDetailsHeader [name="navigateButton"]');
        $(document).off("click", '#itemDetailsPage_dishDetailsContainer [name="proprietorNameLabel"]').on({
            click: function(event) {
                if (!$(this).attr('disabled')) {
                    Apperyio.navigateTo('proprietorPage', {
                        transition: 'flip',
                        reverse: false
                    });
                }
            },
        }, '#itemDetailsPage_dishDetailsContainer [name="proprietorNameLabel"]');
        $(document).off("click", '#itemDetailsPage_dishDetailsContainer [name="ratingAboutButton"]').on({
            click: function(event) {
                if (!$(this).attr('disabled')) {
                    Apperyio.navigateTo('zzratingInfoPage', {
                        transition: 'flip',
                        reverse: false
                    });
                }
            },
        }, '#itemDetailsPage_dishDetailsContainer [name="ratingAboutButton"]');
        $(document).off("click", '#itemDetailsPage_dishDetailsContainer [name="pairingItem"]').on({
            click: function(event) {
                if (!$(this).attr('disabled')) {
                    var itemId = $(this).attr('item_id');
                    storageSet('selectedItem', itemId);
                    //$.mobile.changePage(window.location.href, { allowSamePageTransition: true, transition: "flip", reloadPage: true }); 
                    itemDetails_item_read_service.execute({});
                }
            },
        }, '#itemDetailsPage_dishDetailsContainer [name="pairingItem"]');
        $(document).off("click", '#itemDetailsPage_dishDetailsContainer [name="itemSelectButton"]').on({
            click: function(event) {
                if (!$(this).attr('disabled')) {
                    if (isGuest) {
                        Apperyio('loginGotoPopup').popup('open');
                    } else {
                        var currentItem = storageGet('currentItem'),
                            currentOrder = storageGet('currentOrder') || Apperyio.getModel('currentOrder'),
                            currentOrderItems = storageGet('currentOrderItems') || Apperyio.getModel('orderItems');
                        if (currentOrder.vendor_id !== projectMdb1_settings.vendor_id) {
                            currentOrderItems = Apperyio.getModel('orderItems');
                            currentOrder.vendor_id = projectMdb1_settings.vendor_id;
                        }
                        currentOrderItems.push({
                            id: currentOrder.items.length + '',
                            item_id: currentItem.id,
                            item_name: currentItem.heading,
                            price: currentItem.price
                        });
                        itemDetails_createSelected_service.execute({});
                        storageSet('currentOrder', currentOrder);
                        storageSet('currentOrderItems', currentOrderItems);
                        showPopupWithTimout('addToOrderPopup');
                    };
                }
            },
        }, '#itemDetailsPage_dishDetailsContainer [name="itemSelectButton"]');
        $(document).off("click", '#itemDetailsPage_dishDetailsContainer [name="rateItemButton"]').on({
            click: function(event) {
                if (!$(this).attr('disabled')) {
                    try {
                        $a.storage["tempNumber"].update("$", "3")
                    } catch (e) {
                        console.error(e)
                    };
                    if (isGuest) {
                        Apperyio('loginGotoPopup').popup('open');
                    } else {
                        Apperyio('ratingChoicesPopup').popup('open');
                    };
                }
            },
        }, '#itemDetailsPage_dishDetailsContainer [name="rateItemButton"]');
        $(document).off("click", '#itemDetailsPage_dishDetailsContainer [name="addWishListButton"]').on({
            click: function(event) {
                if (!$(this).attr('disabled')) {
                    Apperyio('wishListNote').val('');
                    if (isGuest) {
                        Apperyio('loginGotoPopup').popup('open');
                    } else {
                        itemDetails_wishlist_query_service.execute({});
                    }
                    ;
                }
            },
        }, '#itemDetailsPage_dishDetailsContainer [name="addWishListButton"]');
        $(document).off("click", '#itemDetailsPage_dishDetailsContainer [name="addFavoriteButton"]').on({
            click: function(event) {
                if (!$(this).attr('disabled')) {
                    if (isGuest) {
                        Apperyio('loginGotoPopup').popup('open');
                    } else {
                        itemDetails_favorites_query_service.execute({});
                    };
                }
            },
        }, '#itemDetailsPage_dishDetailsContainer [name="addFavoriteButton"]');
        $(document).off("click", '#itemDetailsPage_dishDetailsContainer [name="buyButton"]').on({
            click: function(event) {
                if (!$(this).attr('disabled')) {
                    window.open('http://www.wholefoodsmarket.com/recipe/curried-chicken-mango', 'NewWindow', 'width=600,height=400,toolbar=yes,location=yes,directories=yes,status=yes,menubar=yes,scrollbars=yes,copyhistory=yes,resizable=yes');
                }
            },
        }, '#itemDetailsPage_dishDetailsContainer [name="buyButton"]');
        $(document).off("click", '#itemDetailsPage_dishDetailsFooter [name="selectedButton"]').on({
            click: function(event) {
                if (!$(this).attr('disabled')) {
                    Apperyio.navigateTo('selectedPage', {
                        transition: 'pop',
                        reverse: false
                    });
                }
            },
        }, '#itemDetailsPage_dishDetailsFooter [name="selectedButton"]');
        $(document).off("click", '#itemDetailsPage_ratingChoicesPopup [name="detailedRatingButton"]').on({
            click: function(event) {
                if (!$(this).attr('disabled')) {
                    Apperyio.navigateTo('zzdetailedReviewPage', {
                        transition: 'slide',
                        reverse: false
                    });
                }
            },
        }, '#itemDetailsPage_ratingChoicesPopup [name="detailedRatingButton"]');
        $(document).off("click", '#itemDetailsPage_ratingChoicesPopup [name="tasteRatingChoices"]').on({
            click: function(event) {
                if (!$(this).attr('disabled')) {
                    highlightRateItem(this, 2);
                }
            },
        }, '#itemDetailsPage_ratingChoicesPopup [name="tasteRatingChoices"]');
        $(document).off("click", '#itemDetailsPage_ratingChoicesPopup [name="rating5"]').on({
            click: function(event) {
                if (!$(this).attr('disabled')) {
                    highlightRateItem(this, 5);
                    return false;
                }
            },
        }, '#itemDetailsPage_ratingChoicesPopup [name="rating5"]');
        $(document).off("click", '#itemDetailsPage_ratingChoicesPopup [name="rating4"]').on({
            click: function(event) {
                if (!$(this).attr('disabled')) {
                    highlightRateItem(this, 4);
                    return false;
                }
            },
        }, '#itemDetailsPage_ratingChoicesPopup [name="rating4"]');
        $(document).off("click", '#itemDetailsPage_ratingChoicesPopup [name="rating3"]').on({
            click: function(event) {
                if (!$(this).attr('disabled')) {
                    highlightRateItem(this, 3);
                    return false;
                }
            },
        }, '#itemDetailsPage_ratingChoicesPopup [name="rating3"]');
        $(document).off("click", '#itemDetailsPage_ratingChoicesPopup [name="rating2"]').on({
            click: function(event) {
                if (!$(this).attr('disabled')) {
                    highlightRateItem(this, 2);
                    return false;
                }
            },
        }, '#itemDetailsPage_ratingChoicesPopup [name="rating2"]');
        $(document).off("click", '#itemDetailsPage_ratingChoicesPopup [name="rating1"]').on({
            click: function(event) {
                if (!$(this).attr('disabled')) {
                    highlightRateItem(this, 1);
                    return false;
                }
            },
        }, '#itemDetailsPage_ratingChoicesPopup [name="rating1"]');
        $(document).off("click", '#itemDetailsPage_ratingChoicesPopup [name="submitTasteButton"]').on({
            click: function(event) {
                if (!$(this).attr('disabled')) {
                    var rate = storageGet('tempNumber');
                    if (rate < 3) {
                        /*
    setTimeout(function(){
		showPopupWithTimout('messagePopup', 2500);
	}, 150);
	Apperyio('passwordChangePopup').popup('close');
    */
                        setTimeout(function() {
                            log(Apperyio('lowTastePopup'));
                            Apperyio('lowTastePopup').popup('open');
                        }, 400);
                    } else {
                        Apperyio('problemInput').val('');
                        itemDetails_rate_query_service.execute({});
                    }
                    Apperyio('ratingChoicesPopup').popup('close');
                }
            },
        }, '#itemDetailsPage_ratingChoicesPopup [name="submitTasteButton"]');
        $(document).off("click", '#itemDetailsPage_ratingChoicesPopup [name="ratingCancelButton"]').on({
            click: function(event) {
                if (!$(this).attr('disabled')) {
                    Apperyio('addToOrderPopup').popup('close');
                }
            },
        }, '#itemDetailsPage_ratingChoicesPopup [name="ratingCancelButton"]');
        $(document).off("click", '#itemDetailsPage_wishListPopup [name="gotoWishListButton"]').on({
            click: function(event) {
                if (!$(this).attr('disabled')) {
                    Apperyio.navigateTo('wishListPage', {
                        transition: 'slide',
                        reverse: false
                    });
                }
            },
        }, '#itemDetailsPage_wishListPopup [name="gotoWishListButton"]');
        $(document).off("click", '#itemDetailsPage_wishListPopup [name="closePopupButton"]').on({
            click: function(event) {
                if (!$(this).attr('disabled')) {
                    Apperyio('wishListPopup').popup('close');
                    try {
                        itemDetails_wishlist_create_service.execute({});
                    } catch (e) {
                        console.error(e);
                        hideSpinner();
                    };
                }
            },
        }, '#itemDetailsPage_wishListPopup [name="closePopupButton"]');
        $(document).off("click", '#itemDetailsPage_wishListPopup [name="wishlistNotesCancelButton"]').on({
            click: function(event) {
                if (!$(this).attr('disabled')) {
                    Apperyio('addToOrderPopup').popup('close');
                }
            },
        }, '#itemDetailsPage_wishListPopup [name="wishlistNotesCancelButton"]');
        $(document).off("click", '#itemDetailsPage_lowTastePopup [name="submitProblemButton"]').on({
            click: function(event) {
                if (!$(this).attr('disabled')) {
                    Apperyio('lowTastePopup').popup('close');
                    try {
                        itemDetails_rate_query_service.execute({});
                    } catch (e) {
                        console.error(e);
                        hideSpinner();
                    };
                }
            },
        }, '#itemDetailsPage_lowTastePopup [name="submitProblemButton"]');
        $(document).off("click", '#itemDetailsPage_lowTastePopup [name="problemCancelButton"]').on({
            click: function(event) {
                if (!$(this).attr('disabled')) {
                    Apperyio('addToOrderPopup').popup('close');
                }
            },
        }, '#itemDetailsPage_lowTastePopup [name="problemCancelButton"]');
        $(document).off("click", '#itemDetailsPage_loginGotoPopup [name="loginGotoButton"]').on({
            click: function(event) {
                if (!$(this).attr('disabled')) {
                    Apperyio('loginGotoPopup').popup('close');
                    setTimeout(function() {
                        window.location = 'startScreen.html';
                    }, 0);
                }
            },
        }, '#itemDetailsPage_loginGotoPopup [name="loginGotoButton"]');
        $(document).off("click", '#itemDetailsPage_loginGotoPopup [name="loginGotoCancelButton"]').on({
            click: function(event) {
                if (!$(this).attr('disabled')) {
                    Apperyio('loginGotoPopup').popup('close');
                }
            },
        }, '#itemDetailsPage_loginGotoPopup [name="loginGotoCancelButton"]');
    };
    $(document).off("pagebeforeshow", "#itemDetailsPage").on("pagebeforeshow", "#itemDetailsPage", function(event, ui) {
        Apperyio.CurrentScreen = "itemDetailsPage";
        _.chain(Apperyio.mappings)
            .filter(function(m) {
                return m.homeScreen === Apperyio.CurrentScreen;
            })
            .each(Apperyio.UIHandler.hideTemplateComponents);
    });
    itemDetailsPage_onLoad();
};
$(document).off("pagecreate", "#itemDetailsPage").on("pagecreate", "#itemDetailsPage", function(event, ui) {
    Apperyio.processSelectMenu($(this));
    itemDetailsPage_js();
});