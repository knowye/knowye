/*
 * JS for itemEditPage generated by Appery.io
 */
Apperyio.getProjectGUID = function() {
    return '148444cb-eb26-4cec-bc22-29bf794bc529';
};

function navigateTo(outcome, useAjax) {
    Apperyio.navigateTo(outcome, useAjax);
}

function adjustContentHeight() {
    Apperyio.adjustContentHeightWithPadding();
}

function adjustContentHeightWithPadding(_page) {
    Apperyio.adjustContentHeightWithPadding(_page);
}

function setDetailContent(pageUrl) {
    Apperyio.setDetailContent(pageUrl);
}
Apperyio.AppPages = [{
    "name": "aboutPage",
    "location": "aboutPage.html"
}, {
    "name": "itemDetailsPage",
    "location": "itemDetailsPage.html"
}, {
    "name": "menuHeadingManagePage",
    "location": "menuHeadingManagePage.html"
}, {
    "name": "proprietorAnalyticsPage",
    "location": "proprietorAnalyticsPage.html"
}, {
    "name": "zzpromoEdit",
    "location": "zzpromoEdit.html"
}, {
    "name": "startScreen",
    "location": "startScreen.html"
}, {
    "name": "itemPage",
    "location": "itemPage.html"
}, {
    "name": "zzpromoManage",
    "location": "zzpromoManage.html"
}, {
    "name": "zzscannerPage",
    "location": "zzscannerPage.html"
}, {
    "name": "zztimeRangePage",
    "location": "zztimeRangePage.html"
}, {
    "name": "selectedPage",
    "location": "selectedPage.html"
}, {
    "name": "zzCSStestPage",
    "location": "zzCSStestPage.html"
}, {
    "name": "zzmenuPage",
    "location": "zzmenuPage.html"
}, {
    "name": "menuHistoryPage",
    "location": "menuHistoryPage.html"
}, {
    "name": "faqPage",
    "location": "faqPage.html"
}, {
    "name": "zzratingInfoPage",
    "location": "zzratingInfoPage.html"
}, {
    "name": "orderHistoryPage",
    "location": "orderHistoryPage.html"
}, {
    "name": "createAccount",
    "location": "createAccount.html"
}, {
    "name": "itemManagePage",
    "location": "itemManagePage.html"
}, {
    "name": "proprietorStartPage",
    "location": "proprietorStartPage.html"
}, {
    "name": "operationsRestaurantPage",
    "location": "operationsRestaurantPage.html"
}, {
    "name": "zzdetailedReviewPage",
    "location": "zzdetailedReviewPage.html"
}, {
    "name": "itemEditPage",
    "location": "itemEditPage.html"
}, {
    "name": "selectionHistoryPage",
    "location": "selectionHistoryPage.html"
}, {
    "name": "zzproprietorStatPage",
    "location": "zzproprietorStatPage.html"
}, {
    "name": "zzitemInventoryPage",
    "location": "zzitemInventoryPage.html"
}, {
    "name": "zzalertPage",
    "location": "zzalertPage.html"
}, {
    "name": "zzsearchPage",
    "location": "zzsearchPage.html"
}, {
    "name": "menuPage_v2",
    "location": "menuPage_v2.html"
}, {
    "name": "zzqrCodePage",
    "location": "zzqrCodePage.html"
}, {
    "name": "profilePage",
    "location": "profilePage.html"
}, {
    "name": "filterPage",
    "location": "filterPage.html"
}, {
    "name": "easterEggPage",
    "location": "easterEggPage.html"
}, {
    "name": "helpPage",
    "location": "helpPage.html"
}, {
    "name": "navigatePage",
    "location": "navigatePage.html"
}, {
    "name": "menuPreviewPage",
    "location": "menuPreviewPage.html"
}, {
    "name": "zzfacebookLogin",
    "location": "zzfacebookLogin.html"
}, {
    "name": "menu_shared",
    "location": "menu_shared.html"
}, {
    "name": "logoutPage",
    "location": "logoutPage.html"
}, {
    "name": "favoritesPage",
    "location": "favoritesPage.html"
}, {
    "name": "proprietorPage",
    "location": "proprietorPage.html"
}, {
    "name": "wishListPage",
    "location": "wishListPage.html"
}, {
    "name": "menuManagementPage",
    "location": "menuManagementPage.html"
}, {
    "name": "touPage",
    "location": "touPage.html"
}, {
    "name": "zzsettingsPage",
    "location": "zzsettingsPage.html"
}];

function itemEditPage_js() {
    /* Object & array with components "name-to-id" mapping */
    var n2id_buf = {
        'homeButton': 'itemEditPage_homeButton',
        'unavailableGrid': 'itemEditPage_unavailableGrid',
        'unavailableLabelCell': 'itemEditPage_unavailableLabelCell',
        'unavailableItemLabel': 'itemEditPage_unavailableItemLabel',
        'unavailableToggleCell': 'itemEditPage_unavailableToggleCell',
        'unavailableItemToggle': 'itemEditPage_unavailableItemToggle',
        'inactiveGrid': 'itemEditPage_inactiveGrid',
        'inactiveLabelCell': 'itemEditPage_inactiveLabelCell',
        'inactiveLabel': 'itemEditPage_inactiveLabel',
        'inactiveToggleCell': 'itemEditPage_inactiveToggleCell',
        'inactiveToggle': 'itemEditPage_inactiveToggle',
        'itemPasteField': 'itemEditPage_itemPasteField',
        'templateLink': 'itemEditPage_templateLink',
        'orLabel': 'itemEditPage_orLabel',
        'skuGrid': 'itemEditPage_skuGrid',
        'skuLabelCell': 'itemEditPage_skuLabelCell',
        'skuLabel': 'itemEditPage_skuLabel',
        'skuCell': 'itemEditPage_skuCell',
        'skuInput': 'itemEditPage_skuInput',
        'itemNameField': 'itemEditPage_itemNameField',
        'itemDescriptionField': 'itemEditPage_itemDescriptionField',
        'priceGrid': 'itemEditPage_priceGrid',
        'dollarSignCell': 'itemEditPage_dollarSignCell',
        'dollarSignLabel': 'itemEditPage_dollarSignLabel',
        'priceCell': 'itemEditPage_priceCell',
        'itemPriceField': 'itemEditPage_itemPriceField',
        'calorieLabelCell': 'itemEditPage_calorieLabelCell',
        'calorieLabel': 'itemEditPage_calorieLabel',
        'calorieCell': 'itemEditPage_calorieCell',
        'calories': 'itemEditPage_calories',
        'menuHeadingLabel': 'itemEditPage_menuHeadingLabel',
        'headingGrid': 'itemEditPage_headingGrid',
        'headingCell': 'itemEditPage_headingCell',
        'menuHeadingSelect': 'itemEditPage_menuHeadingSelect',
        'menuHeadingSelect-0': 'itemEditPage_menuHeadingSelect-0',
        'classificationLabel': 'itemEditPage_classificationLabel',
        'classificationSelect': 'itemEditPage_classificationSelect',
        'classificationSelect-0': 'itemEditPage_classificationSelect-0',
        'propertyLabel': 'itemEditPage_propertyLabel',
        'propertySelectButton': 'itemEditPage_propertySelectButton',
        'propertySelectButton-0': 'itemEditPage_propertySelectButton-0',
        'pairingGrid': 'itemEditPage_pairingGrid',
        'pairingLabelCell': 'itemEditPage_pairingLabelCell',
        'pairingLabel': 'itemEditPage_pairingLabel',
        'pairingSelectCell': 'itemEditPage_pairingSelectCell',
        'pairingSelectButton': 'itemEditPage_pairingSelectButton',
        'pairingSelectButton-0': 'itemEditPage_pairingSelectButton-0',
        'ingredientAddButton': 'itemEditPage_ingredientAddButton',
        'spacer_10': 'itemEditPage_spacer_10',
        'ingredientHiddenLabel': 'itemEditPage_ingredientHiddenLabel',
        'ingredientHiddenConfidentialLabel': 'itemEditPage_ingredientHiddenConfidentialLabel',
        'ingredientHidden': 'itemEditPage_ingredientHidden',
        'itemTimeRangeLabel': 'itemEditPage_itemTimeRangeLabel',
        'timeRangeSelect': 'itemEditPage_timeRangeSelect',
        'timeRangeSelect-0': 'itemEditPage_timeRangeSelect-0',
        'itemImageGrid': 'itemEditPage_itemImageGrid',
        'mobilegridcell_26': 'itemEditPage_mobilegridcell_26',
        'itemPhoto': 'itemEditPage_itemPhoto',
        'fileSelect': 'itemEditPage_fileSelect',
        'photoButtonGrid': 'itemEditPage_photoButtonGrid',
        'photoAddCell': 'itemEditPage_photoAddCell',
        'photoAddButton': 'itemEditPage_photoAddButton',
        'photoDeleteCell': 'itemEditPage_photoDeleteCell',
        'photoDeleteButton': 'itemEditPage_photoDeleteButton',
        'multiselectGrid': 'itemEditPage_multiselectGrid',
        'multiselectCell': 'itemEditPage_multiselectCell',
        'multiselectLabel': 'itemEditPage_multiselectLabel',
        'html_multiselect': 'itemEditPage_html_multiselect',
        'mobilegridcell_30': 'itemEditPage_mobilegridcell_30',
        'buttonGridSaveDeleteCancelGrid': 'itemEditPage_buttonGridSaveDeleteCancelGrid',
        'saveCell': 'itemEditPage_saveCell',
        'itemEditSaveButton': 'itemEditPage_itemEditSaveButton',
        'deleteCell': 'itemEditPage_deleteCell',
        'deleteButton': 'itemEditPage_deleteButton',
        'cancelCell': 'itemEditPage_cancelCell',
        'cancelButton': 'itemEditPage_cancelButton',
        'ingredientAddPopupLabel1': 'itemEditPage_ingredientAddPopupLabel1',
        'ingredientVisibilityChoiceRadio': 'itemEditPage_ingredientVisibilityChoiceRadio',
        'ingredientMainRadio': 'itemEditPage_ingredientMainRadio',
        'ingredientFeaturedRadio': 'itemEditPage_ingredientFeaturedRadio',
        'ingredientHIDDENRadio': 'itemEditPage_ingredientHIDDENRadio',
        'ingredientField': 'itemEditPage_ingredientField',
        'ingredientCooktechLabel': 'itemEditPage_ingredientCooktechLabel',
        'cooktechSelect': 'itemEditPage_cooktechSelect',
        'cooktechSelect-0': 'itemEditPage_cooktechSelect-0',
        'ingredientAttributeLabel': 'itemEditPage_ingredientAttributeLabel',
        'mobileselectmenu_24': 'itemEditPage_mobileselectmenu_24',
        'mobileselectmenu_24-0': 'itemEditPage_mobileselectmenu_24-0',
        'ingredientButtonGrid': 'itemEditPage_ingredientButtonGrid',
        'ingredientSaveCell': 'itemEditPage_ingredientSaveCell',
        'ingredientAddSaveButton': 'itemEditPage_ingredientAddSaveButton',
        'ingredientCancelCell': 'itemEditPage_ingredientCancelCell',
        'ingredientAddCancelButton': 'itemEditPage_ingredientAddCancelButton',
        'deleteConfirmLabel': 'itemEditPage_deleteConfirmLabel',
        'deleteConfirmGrid': 'itemEditPage_deleteConfirmGrid',
        'deleteConfirmCell': 'itemEditPage_deleteConfirmCell',
        'deleteConfirmButton': 'itemEditPage_deleteConfirmButton',
        'deleteCancelCell': 'itemEditPage_deleteCancelCell',
        'deleteCancelButton': 'itemEditPage_deleteCancelButton',
        'deletePhotoConfirmLabel': 'itemEditPage_deletePhotoConfirmLabel',
        'deletePhotoConfirmGrid': 'itemEditPage_deletePhotoConfirmGrid',
        'confirmPhotoDeleteCell': 'itemEditPage_confirmPhotoDeleteCell',
        'deletePhotoConfirmButton': 'itemEditPage_deletePhotoConfirmButton',
        'deletePhotoCancelCell': 'itemEditPage_deletePhotoCancelCell',
        'deletePhotoCancelButton': 'itemEditPage_deletePhotoCancelButton'
    };
    if ("n2id" in window && window.n2id !== undefined) {
        $.extend(n2id, n2id_buf);
    } else {
        window.n2id = n2id_buf;
    }
    /*
     * Nonvisual components
     */
    Apperyio.mappings = Apperyio.mappings || {};
    Apperyio.mappings["itemEditPage_item_create_service_onsuccess_mapping_1"] = {
        "homeScreen": "itemEditPage",
        "directions": [
            {
                "from_name": "item_create_service",
                "from_type": "SERVICE_RESPONSE",
                "to_name": "currentItem",
                "to_type": "SESSION_STORAGE",
                "mappings": [
                    {
                        "source": "$['body']['_id']",
                        "target": "$['id']"
                    }
                ]
            },
            {
                "from_name": "item_create_service",
                "from_type": "SERVICE_RESPONSE",
                "to_name": "selectedItem",
                "to_type": "SESSION_STORAGE",
                "mappings": [
                    {
                        "source": "$['body']['_id']",
                        "target": "$"
                    }
                ]
            }
        ]
    };
    Apperyio.mappings["itemEditPage_item_create_service_onbeforesend_mapping_0"] = {
        "homeScreen": "itemEditPage",
        "directions": [
            {
                "from_name": "itemEditPage",
                "from_type": "UI",
                "to_name": "item_create_service",
                "to_type": "SERVICE_REQUEST",
                "to_default": {
                    "headers": {
                        "X-Appery-Database-Id": "{database_id}",
                        "X-Appery-Session-Token": "{session_token}",
                        "Content-Type": "application/json"
                    },
                    "parameters": {},
                    "body": {
                        "vendor_lk": {
                            "collName": "vendor"
                        },
                        "heading": {
                            "collName": "menuHeading"
                        },
                        "acl": {
                            "*": {
                                "write": true,
                                "read": true
                            }
                        }
                    }
                },
                "mappings": [
                    {
                        "source": "$['itemNameField:text']",
                        "target": "$['body']['name']"
                    },
                    {
                        "source": "$['itemDescriptionField:text']",
                        "target": "$['body']['description']"
                    },
                    {
                        "source": "$['propertySelectButton:selectedMenuItem']",
                        "target": "$['body']['properties']"
                    },
                    {
                        "source": "$['unavailableItemToggle:toggled']",
                        "target_transformation": function(value) {
                            return value === 'on' ? true : false;
                        },
                        "target": "$['body']['hidden']"
                    },
                    {
                        "source": "$['calories:text']",
                        "target": "$['body']['calories']"
                    },
                    {
                        "source": "$['itemPriceField:text']",
                        "target": "$['body']['price']"
                    },
                    {
                        "source": "$['menuHeadingSelect:selectedMenuItem']",
                        "target_transformation": function(value) {
                            if (value) {
                                return {
                                    collName: "menuHeading",
                                    _id: value
                                };
                            } else {
                                return null;
                            }
                        },
                        "target": "$['body']['heading']"
                    },
                    {
                        "source": "$['skuInput:text']",
                        "target": "$['body']['sku']"
                    },
                    {
                        "source": "$['inactiveToggle:toggled']",
                        "target_transformation": function(value) {
                            return value === 'on' ? true : false;
                        },
                        "target": "$['body']['hideSeasonal']"
                    }
                ]
            },
            {
                "from_name": "currentItem",
                "from_type": "SESSION_STORAGE",
                "to_name": "item_create_service",
                "to_type": "SERVICE_REQUEST",
                "to_default": {
                    "headers": {
                        "X-Appery-Database-Id": "{database_id}",
                        "X-Appery-Session-Token": "{session_token}",
                        "Content-Type": "application/json"
                    },
                    "parameters": {},
                    "body": {
                        "vendor_lk": {
                            "collName": "vendor"
                        },
                        "heading": {
                            "collName": "menuHeading"
                        },
                        "acl": {
                            "*": {
                                "write": true,
                                "read": true
                            }
                        }
                    }
                },
                "mappings": [
                    {
                        "source": "$['order']",
                        "target": "$['body']['order']"
                    }
                ]
            },
            {
                "from_name": "itemEditPage",
                "from_type": "UI",
                "to_name": "currentItem",
                "to_type": "SESSION_STORAGE",
                "mappings": [
                    {
                        "source": "$['itemNameField:text']",
                        "target": "$['heading']"
                    },
                    {
                        "source": "$['itemDescriptionField:text']",
                        "target": "$['description']"
                    },
                    {
                        "source": "$['itemPriceField:text']",
                        "target": "$['price']"
                    },
                    {
                        "source": "$['unavailableItemToggle:toggled']",
                        "target_transformation": function(value) {
                            return value === 'on' ? true : false;
                        },
                        "target": "$['isHidden']"
                    },
                    {
                        "source": "$['menuHeadingSelect:selectedMenuItem']",
                        "target": "$['parent_id']"
                    }
                ]
            },
            {
                "from_name": "vendorId",
                "from_type": "SESSION_STORAGE",
                "to_name": "item_create_service",
                "to_type": "SERVICE_REQUEST",
                "to_default": {
                    "headers": {
                        "X-Appery-Database-Id": "{database_id}",
                        "X-Appery-Session-Token": "{session_token}",
                        "Content-Type": "application/json"
                    },
                    "parameters": {},
                    "body": {
                        "vendor_lk": {
                            "collName": "vendor"
                        },
                        "heading": {
                            "collName": "menuHeading"
                        },
                        "acl": {
                            "*": {
                                "write": true,
                                "read": true
                            }
                        }
                    }
                },
                "mappings": [
                    {
                        "source": "$",
                        "target": "$['body']['vendor_lk']['_id']"
                    }
                ]
            },
            {
                "from_name": "fileInfo",
                "from_type": "SESSION_STORAGE",
                "to_name": "item_create_service",
                "to_type": "SERVICE_REQUEST",
                "to_default": {
                    "headers": {
                        "X-Appery-Database-Id": "{database_id}",
                        "X-Appery-Session-Token": "{session_token}",
                        "Content-Type": "application/json"
                    },
                    "parameters": {},
                    "body": {
                        "vendor_lk": {
                            "collName": "vendor"
                        },
                        "heading": {
                            "collName": "menuHeading"
                        },
                        "acl": {
                            "*": {
                                "write": true,
                                "read": true
                            }
                        }
                    }
                },
                "mappings": [
                    {
                        "source": "$",
                        "target_transformation": function(value) {
                            if (!value) {
                                return null;
                            }
                        },
                        "target": "$['body']['image']"
                    }
                ]
            },
            {
                "from_name": "itemPrefs",
                "from_type": "SESSION_STORAGE",
                "to_name": "item_create_service",
                "to_type": "SERVICE_REQUEST",
                "to_default": {
                    "headers": {
                        "X-Appery-Database-Id": "{database_id}",
                        "X-Appery-Session-Token": "{session_token}",
                        "Content-Type": "application/json"
                    },
                    "parameters": {},
                    "body": {
                        "vendor_lk": {
                            "collName": "vendor"
                        },
                        "heading": {
                            "collName": "menuHeading"
                        },
                        "acl": {
                            "*": {
                                "write": true,
                                "read": true
                            }
                        }
                    }
                },
                "mappings": [
                    {
                        "source": "$",
                        "target": "$['body']['includePrefs']"
                    }
                ]
            }
        ]
    };
    Apperyio.mappings["itemEditPage_item_read_service_onsuccess_mapping_1"] = {
        "homeScreen": "itemEditPage",
        "directions": [
            {
                "from_name": "headingSelectList",
                "from_type": "SESSION_STORAGE",
                "to_name": "itemEditPage",
                "to_type": "UI",
                "mappings": [
                    {
                        "source": "$[i]",
                        "target": "$['menuHeadingSelect-0']"
                    },
                    {
                        "source": "$[i]['id']",
                        "target": "$['menuHeadingSelect-0:value']"
                    },
                    {
                        "source": "$[i]['heading']",
                        "target": "$['menuHeadingSelect-0:label']"
                    }
                ]
            }
        ]
    };
    Apperyio.mappings["itemEditPage_item_read_service_onsuccess_mapping_2"] = {
        "homeScreen": "itemEditPage",
        "directions": [
            {
                "from_name": "item_read_service",
                "from_type": "SERVICE_RESPONSE",
                "to_name": "itemEditPage",
                "to_type": "UI",
                "mappings": [
                    {
                        "source": "$['body']['name']",
                        "target": "$['itemNameField:text']"
                    },
                    {
                        "source": "$['body']['description']",
                        "target": "$['itemDescriptionField:text']"
                    },
                    {
                        "source": "$['body']['price']",
                        "target": "$['itemPriceField:text']"
                    },
                    {
                        "source": "$['body']['image']['fileName']",
                        "target_transformation": function(value, element) {
                            if (value) {
                                return "https://api.appery.io/rest/1/db/files/" + Settings.database_id + "/" + value;
                            }
                        },
                        "target": "$['itemPhoto:image']"
                    },
                    {
                        "source": "$['body']['hidden']",
                        "target": "$['unavailableItemToggle:toggled']"
                    },
                    {
                        "source": "$['body']['heading']['_id']",
                        "target": "$['menuHeadingSelect:selectedMenuItem']"
                    },
                    {
                        "source": "$['body']['calories']",
                        "target_transformation": function(value, element) {
                            return value || 0;
                        },
                        "target": "$['calories:text']"
                    },
                    {
                        "source": "$['body']['image']['fileName']",
                        "target_transformation": function(value, element) {
                            return value ? true : false;
                        },
                        "target": "$['itemImageGrid:visible']"
                    },
                    {
                        "source": "$['body']['sku']",
                        "target": "$['skuInput:text']"
                    },
                    {
                        "source": "$['body']['hideSeasonal']",
                        "target": "$['inactiveToggle:toggled']"
                    }
                ]
            },
            {
                "from_name": "item_read_service",
                "from_type": "SERVICE_RESPONSE",
                "to_name": "tempString",
                "to_type": "SESSION_STORAGE",
                "mappings": [
                    {
                        "source": "$['body']['properties']",
                        "target": "$"
                    }
                ]
            },
            {
                "from_name": "item_read_service",
                "from_type": "SERVICE_RESPONSE",
                "to_name": "fileInfo",
                "to_type": "SESSION_STORAGE",
                "mappings": [
                    {
                        "source": "$['body']['image']['fileName']",
                        "target": "$['fileName']"
                    },
                    {
                        "source": "$['body']['image']['originalFileName']",
                        "target": "$['originalFileName']"
                    }
                ]
            },
            {
                "from_name": "item_read_service",
                "from_type": "SERVICE_RESPONSE",
                "to_name": "oldParentId",
                "to_type": "SESSION_STORAGE",
                "mappings": [
                    {
                        "source": "$['body']['heading']['_id']",
                        "target": "$"
                    }
                ]
            }
        ]
    };
    Apperyio.mappings["itemEditPage_item_read_service_onbeforesend_mapping_0"] = {
        "homeScreen": "itemEditPage",
        "directions": [
            {
                "from_name": "selectedItem",
                "from_type": "SESSION_STORAGE",
                "to_name": "item_read_service",
                "to_type": "SERVICE_REQUEST",
                "to_default": {
                    "headers": {
                        "X-Appery-Database-Id": "{database_id}"
                    },
                    "parameters": {
                        "include": "vendor_lk,vendor_lk.state,vendor_lk.country,heading,heading.vendor,heading.vendor.state,heading.vendor.country,heading.headingParent"
                    },
                    "body": null
                },
                "mappings": [
                    {
                        "source": "$",
                        "target": "$['parameters']['_id']"
                    }
                ]
            }
        ]
    };
    Apperyio.mappings["itemEditPage_item_update_service_onbeforesend_mapping_0"] = {
        "homeScreen": "itemEditPage",
        "directions": [
            {
                "from_name": "selectedItem",
                "from_type": "SESSION_STORAGE",
                "to_name": "item_update_service",
                "to_type": "SERVICE_REQUEST",
                "to_default": {
                    "headers": {
                        "X-Appery-Database-Id": "{database_id}",
                        "X-Appery-Session-Token": "{session_token}",
                        "Content-Type": "application/json"
                    },
                    "parameters": {},
                    "body": {
                        "heading": {
                            "collName": "menuHeading"
                        },
                        "acl": {
                            "*": {
                                "write": true,
                                "read": true
                            }
                        }
                    }
                },
                "mappings": [
                    {
                        "source": "$",
                        "target": "$['parameters']['_id']"
                    }
                ]
            },
            {
                "from_name": "itemEditPage",
                "from_type": "UI",
                "to_name": "item_update_service",
                "to_type": "SERVICE_REQUEST",
                "to_default": {
                    "headers": {
                        "X-Appery-Database-Id": "{database_id}",
                        "X-Appery-Session-Token": "{session_token}",
                        "Content-Type": "application/json"
                    },
                    "parameters": {},
                    "body": {
                        "heading": {
                            "collName": "menuHeading"
                        },
                        "acl": {
                            "*": {
                                "write": true,
                                "read": true
                            }
                        }
                    }
                },
                "mappings": [
                    {
                        "source": "$['itemNameField:text']",
                        "target": "$['body']['name']"
                    },
                    {
                        "source": "$['itemDescriptionField:text']",
                        "target": "$['body']['description']"
                    },
                    {
                        "source": "$['itemPriceField:text']",
                        "target_transformation": function(value) {
                            if (value) {
                                return parseFloat(value);
                            }
                        },
                        "target": "$['body']['price']"
                    },
                    {
                        "source": "$['propertySelectButton:selectedMenuItem']",
                        "target": "$['body']['properties']"
                    },
                    {
                        "source": "$['unavailableItemToggle:toggled']",
                        "target_transformation": function(value) {
                            return value === 'on' ? true : false;
                        },
                        "target": "$['body']['hidden']"
                    },
                    {
                        "source": "$['calories:text']",
                        "target": "$['body']['calories']"
                    },
                    {
                        "source": "$['menuHeadingSelect:selectedMenuItem']",
                        "target_transformation": function(value) {
                            if (value) {
                                return {
                                    collName: "menuHeading",
                                    _id: value
                                };
                            } else {
                                return null;
                            }
                        },
                        "target": "$['body']['heading']"
                    },
                    {
                        "source": "$['skuInput:text']",
                        "target": "$['body']['sku']"
                    },
                    {
                        "source": "$['inactiveToggle:toggled']",
                        "target_transformation": function(value) {
                            return value === 'on' ? true : false;
                        },
                        "target": "$['body']['hideSeasonal']"
                    }
                ]
            },
            {
                "from_name": "itemEditPage",
                "from_type": "UI",
                "to_name": "currentItem",
                "to_type": "SESSION_STORAGE",
                "mappings": [
                    {
                        "source": "$['itemNameField:text']",
                        "target": "$['heading']"
                    },
                    {
                        "source": "$['itemDescriptionField:text']",
                        "target": "$['description']"
                    },
                    {
                        "source": "$['itemPriceField:text']",
                        "target": "$['price']"
                    },
                    {
                        "source": "$['unavailableItemToggle:toggled']",
                        "target_transformation": function(value) {
                            return value === 'on' ? true : false;
                        },
                        "target": "$['isHidden']"
                    },
                    {
                        "source": "$['menuHeadingSelect:selectedMenuItem']",
                        "target": "$['parent_id']"
                    }
                ]
            },
            {
                "from_name": "selectedItem",
                "from_type": "SESSION_STORAGE",
                "to_name": "currentItem",
                "to_type": "SESSION_STORAGE",
                "mappings": [
                    {
                        "source": "$",
                        "target": "$['id']"
                    }
                ]
            },
            {
                "from_name": "itemPrefs",
                "from_type": "SESSION_STORAGE",
                "to_name": "item_update_service",
                "to_type": "SERVICE_REQUEST",
                "to_default": {
                    "headers": {
                        "X-Appery-Database-Id": "{database_id}",
                        "X-Appery-Session-Token": "{session_token}",
                        "Content-Type": "application/json"
                    },
                    "parameters": {},
                    "body": {
                        "heading": {
                            "collName": "menuHeading"
                        },
                        "acl": {
                            "*": {
                                "write": true,
                                "read": true
                            }
                        }
                    }
                },
                "mappings": [
                    {
                        "source": "$",
                        "target": "$['body']['includePrefs']"
                    }
                ]
            }
        ]
    };
    Apperyio.mappings["itemEditPage_item_map_service_onsuccess_mapping_1"] = {
        "homeScreen": "itemEditPage",
        "directions": [
            {
                "from_name": "headingSelectList",
                "from_type": "SESSION_STORAGE",
                "to_name": "itemEditPage",
                "to_type": "UI",
                "mappings": [
                    {
                        "source": "$[i]",
                        "target": "$['menuHeadingSelect-0']"
                    },
                    {
                        "source": "$[i]['id']",
                        "target": "$['menuHeadingSelect-0:value']"
                    },
                    {
                        "source": "$[i]['heading']",
                        "target": "$['menuHeadingSelect-0:label']"
                    }
                ]
            }
        ]
    };
    Apperyio.mappings["itemEditPage_item_map_service_onsuccess_mapping_2"] = {
        "homeScreen": "itemEditPage",
        "directions": [
            {
                "from_name": "selectedParentItem",
                "from_type": "SESSION_STORAGE",
                "to_name": "itemEditPage",
                "to_type": "UI",
                "mappings": [
                    {
                        "source": "$",
                        "target": "$['menuHeadingSelect:selectedMenuItem']"
                    }
                ]
            }
        ]
    };
    Apperyio.mappings["itemEditPage_item_menuHeading_list_service_onsuccess_mapping_0"] = {
        "homeScreen": "itemEditPage",
        "directions": [
            {
                "from_name": "item_menuHeading_list_service",
                "from_type": "SERVICE_RESPONSE",
                "to_name": "menuHeading",
                "to_type": "SESSION_STORAGE",
                "mappings": [
                    {
                        "source": "$['body'][i]['_id']",
                        "target": "$[i]['id']"
                    },
                    {
                        "source": "$['body'][i]['headingParent']['_id']",
                        "target": "$[i]['parent_id']"
                    },
                    {
                        "source": "$['body'][i]['heading']",
                        "target": "$[i]['heading']"
                    },
                    {
                        "source": "$['body'][i]['headingDescription']",
                        "target": "$[i]['description']"
                    },
                    {
                        "source": "$['body'][i]['price']",
                        "target": "$[i]['price']"
                    }
                ]
            }
        ]
    };
    Apperyio.mappings["itemEditPage_item_menuHeading_list_service_onbeforesend_mapping_0"] = {
        "homeScreen": "itemEditPage",
        "directions": [
            {
                "to_name": "item_menuHeading_list_service",
                "to_type": "SERVICE_REQUEST",
                "to_default": {
                    "headers": {
                        "X-Appery-Database-Id": "{database_id}",
                        "X-Appery-Session-Token": "{session_token}"
                    },
                    "parameters": {
                        "include": "vendor,vendor.state,vendor.country,headingParent,headingParent.vendor,headingParent.vendor.state,headingParent.vendor.country,headingParent.headingParent,headingParent.headingParent.vendor,headingParent.headingParent.vendor.state,headingParent.headingParent.vendor.country,headingParent.headingParent.headingParent,headingParent.headingParent.headingParent.vendor,headingParent.headingParent.headingParent.vendor.state,headingParent.headingParent.headingParent.vendor.country,headingParent.headingParent.headingParent.headingParent,headingParent.headingParent.headingParent.headingParent.vendor,headingParent.headingParent.headingParent.headingParent.headingParent",
                        "sort": "order",
                        "where": " {\"vendor\": {\"$inQuery\" : { \"_id\": \"{vendor_id}\"}}}",
                        "limit": "1500"
                    },
                    "body": null
                },
                "mappings": []
            }
        ]
    };
    Apperyio.mappings["itemEditPage_item_delete_service_onbeforesend_mapping_0"] = {
        "homeScreen": "itemEditPage",
        "directions": [
            {
                "from_name": "selectedItem",
                "from_type": "SESSION_STORAGE",
                "to_name": "item_delete_service",
                "to_type": "SERVICE_REQUEST",
                "to_default": {
                    "headers": {
                        "X-Appery-Database-Id": "{database_id}",
                        "X-Appery-Session-Token": "{session_token}"
                    },
                    "parameters": {},
                    "body": null
                },
                "mappings": [
                    {
                        "source": "$",
                        "target": "$['parameters']['_id']"
                    }
                ]
            }
        ]
    };
    Apperyio.mappings["itemEditPage_item_camera_onsuccess_mapping_0"] = {
        "homeScreen": "itemEditPage",
        "directions": [
            {
                "from_name": "item_camera",
                "from_type": "SERVICE_RESPONSE",
                "to_name": "imageDataBase64",
                "to_type": "VARIABLE_STORAGE",
                "mappings": [
                    {
                        "source": "$['data']['imageDataBase64']",
                        "target": "$"
                    }
                ]
            },
            {
                "from_name": "item_camera",
                "from_type": "SERVICE_RESPONSE",
                "to_name": "itemEditPage",
                "to_type": "UI",
                "mappings": [
                    {
                        "source": "$['data']['imageDataBase64']",
                        "target": "$['itemPhoto:image']"
                    }
                ]
            }
        ]
    };
    Apperyio.mappings["itemEditPage_item_camera_onbeforesend_mapping_0"] = {
        "homeScreen": "itemEditPage",
        "directions": [
            {
                "to_name": "item_camera",
                "to_type": "SERVICE_REQUEST",
                "to_default": {
                    "data": {
                        "quality": 80,
                        "destinationType": "Data URL",
                        "sourceType": "Camera",
                        "allowEdit": true,
                        "encodingType": "JPEG",
                        "targetWidth": 1024,
                        "targetHeight": 768
                    }
                },
                "mappings": []
            }
        ]
    };
    Apperyio.mappings["itemEditPage_item_files_upload_service_onbeforesend_mapping_0"] = {
        "homeScreen": "itemEditPage",
        "directions": [
            {
                "to_name": "item_files_upload_service",
                "to_type": "SERVICE_REQUEST",
                "to_default": {
                    "headers": {
                        "X-Appery-Database-Id": "{database_id}",
                        "X-Appery-Session-Token": "{session_token}",
                        "X-Appery-Master-Key": "{database_master_key}"
                    },
                    "parameters": {},
                    "body": null
                },
                "mappings": []
            }
        ]
    };
    Apperyio.mappings["itemEditPage_item_property_query_service_onsuccess_mapping_0"] = {
        "homeScreen": "itemEditPage",
        "directions": [
            {
                "from_name": "item_property_query_service",
                "from_type": "SERVICE_RESPONSE",
                "to_name": "itemEditPage",
                "to_type": "UI",
                "mappings": [
                    {
                        "source": "$['body'][i]",
                        "target": "$['propertySelectButton-0']"
                    },
                    {
                        "source": "$['body'][i]['key']",
                        "target": "$['propertySelectButton-0:value']"
                    },
                    {
                        "source": "$['body'][i]['name']",
                        "target": "$['propertySelectButton-0:label']"
                    }
                ]
            }
        ]
    };
    Apperyio.mappings["itemEditPage_item_property_query_service_onbeforesend_mapping_0"] = {
        "homeScreen": "itemEditPage",
        "directions": [
            {
                "to_name": "item_property_query_service",
                "to_type": "SERVICE_REQUEST",
                "to_default": {
                    "headers": {
                        "X-Appery-Database-Id": "{database_id}",
                        "X-Appery-Session-Token": "{session_token}"
                    },
                    "parameters": {
                        "where": "{\"is_characteristic\": true}"
                    },
                    "body": null
                },
                "mappings": []
            }
        ]
    };
    Apperyio.mappings["itemEditPage_item_files_delete_service_onbeforesend_mapping_0"] = {
        "homeScreen": "itemEditPage",
        "directions": [
            {
                "from_name": "fileInfo",
                "from_type": "SESSION_STORAGE",
                "to_name": "item_files_delete_service",
                "to_type": "SERVICE_REQUEST",
                "to_default": {
                    "headers": {
                        "X-Appery-Database-Id": "{database_id}",
                        "X-Appery-Session-Token": "{session_token}",
                        "X-Appery-Master-Key": "{database_master_key}"
                    },
                    "parameters": {},
                    "body": null
                },
                "mappings": [
                    {
                        "source": "$['fileName']",
                        "target": "$['parameters']['file_name']"
                    }
                ]
            }
        ]
    };
    Apperyio.mappings["itemEditPage_item_update_image_service_onbeforesend_mapping_0"] = {
        "homeScreen": "itemEditPage",
        "directions": [
            {
                "from_name": "selectedItem",
                "from_type": "SESSION_STORAGE",
                "to_name": "item_update_image_service",
                "to_type": "SERVICE_REQUEST",
                "to_default": {
                    "headers": {
                        "X-Appery-Database-Id": "{database_id}",
                        "X-Appery-Session-Token": "{session_token}",
                        "Content-Type": "application/json"
                    },
                    "parameters": {},
                    "body": {
                        "acl": {
                            "*": {
                                "write": true,
                                "read": true
                            }
                        }
                    }
                },
                "mappings": [
                    {
                        "source": "$",
                        "target": "$['parameters']['_id']"
                    }
                ]
            },
            {
                "from_name": "fileInfo",
                "from_type": "SESSION_STORAGE",
                "to_name": "item_update_image_service",
                "to_type": "SERVICE_REQUEST",
                "to_default": {
                    "headers": {
                        "X-Appery-Database-Id": "{database_id}",
                        "X-Appery-Session-Token": "{session_token}",
                        "Content-Type": "application/json"
                    },
                    "parameters": {},
                    "body": {
                        "acl": {
                            "*": {
                                "write": true,
                                "read": true
                            }
                        }
                    }
                },
                "mappings": [
                    {
                        "source": "$['fileName']",
                        "target": "$['body']['image']['fileName']"
                    },
                    {
                        "source": "$['originalFileName']",
                        "target": "$['body']['image']['originalFileName']"
                    }
                ]
            }
        ]
    };
    Apperyio.mappings["itemEditPage_item_getMenuHierarchy_service_onsuccess_mapping_1"] = {
        "homeScreen": "itemEditPage",
        "directions": [
            {
                "from_name": "item_getMenuHierarchy_service",
                "from_type": "SERVICE_RESPONSE",
                "to_name": "itemEditPage",
                "to_type": "UI",
                "mappings": [
                    {
                        "source": "$['body'][i]",
                        "target": "$['menuHeadingSelect-0']"
                    },
                    {
                        "source": "$['body'][i]['_id']",
                        "target": "$['menuHeadingSelect-0:value']"
                    },
                    {
                        "source": "$['body'][i]['heading']",
                        "target": "$['menuHeadingSelect-0:label']"
                    }
                ]
            },
            {
                "from_name": "selectedParentItem",
                "from_type": "SESSION_STORAGE",
                "to_name": "itemEditPage",
                "to_type": "UI",
                "mappings": [
                    {
                        "source": "$",
                        "target": "$['menuHeadingSelect:selectedMenuItem']"
                    }
                ]
            }
        ]
    };
    Apperyio.mappings["itemEditPage_item_getMenuHierarchy_service_onbeforesend_mapping_0"] = {
        "homeScreen": "itemEditPage",
        "directions": [
            {
                "from_name": "vendorId",
                "from_type": "SESSION_STORAGE",
                "to_name": "item_getMenuHierarchy_service",
                "to_type": "SERVICE_REQUEST",
                "to_default": {
                    "headers": {
                        "Content-Type": "application/json"
                    },
                    "parameters": {
                        "vendorId": "{vendor_id}",
                        "onlyHeading": "true",
                        "profileUseToggle": "off",
                        "hideEmpty": "off"
                    },
                    "body": null
                },
                "mappings": [
                    {
                        "source": "$",
                        "target": "$['parameters']['vendorId']"
                    }
                ]
            },
            {
                "from_name": "sessionToken",
                "from_type": "SESSION_STORAGE",
                "to_name": "item_getMenuHierarchy_service",
                "to_type": "SERVICE_REQUEST",
                "to_default": {
                    "headers": {
                        "Content-Type": "application/json"
                    },
                    "parameters": {
                        "vendorId": "{vendor_id}",
                        "onlyHeading": "true",
                        "profileUseToggle": "off",
                        "hideEmpty": "off"
                    },
                    "body": null
                },
                "mappings": [
                    {
                        "source": "$",
                        "target": "$['headers']['X-Appery-Session-Token']"
                    }
                ]
            }
        ]
    };
    Apperyio.mappings["itemEditPage_item_updateMenuCache_service_onsuccess_mapping_0"] = {
        "homeScreen": "itemEditPage",
        "directions": []
    };
    Apperyio.mappings["itemEditPage_item_updateMenuCache_service_onbeforesend_mapping_0"] = {
        "homeScreen": "itemEditPage",
        "directions": [
            {
                "from_name": "vendorId",
                "from_type": "SESSION_STORAGE",
                "to_name": "item_updateMenuCache_service",
                "to_type": "SERVICE_REQUEST",
                "to_default": {
                    "headers": {
                        "Content-Type": "text/plain",
                        "X-Appery-Database-Id": "{database_id}",
                        "X-Appery-Session-Token": "{session_token}"
                    },
                    "parameters": {},
                    "body": null
                },
                "mappings": [
                    {
                        "source": "$",
                        "target": "$['parameters']['vendorId']"
                    }
                ]
            }
        ]
    };
    Apperyio.datasources = Apperyio.datasources || {};
    window.item_create_service = Apperyio.datasources.item_create_service = new Apperyio.DataSource(projectMdb1_item_create_service, {
        "onBeforeSend": function(jqXHR) {
            Apperyio.processMappingAction(Apperyio.mappings["itemEditPage_item_create_service_onbeforesend_mapping_0"]);
        },
        "onComplete": function(jqXHR, textStatus) {
        },
        "onSuccess": function(data) {
            var lst = storageGet('menuItemsList'),
                curentItem = storageGet('currentItem');
            lst.push(curentItem);
            storageSet('menuItemsList', lst);
            storageSet('menuHierarchyList', []);
            var imgData = storageGet('imageDataBase64');
            if (imgData) {
                item_files_delete_service.execute({});
            } else {
                window.history.back();
            }
            ;
            Apperyio.processMappingAction(Apperyio.mappings["itemEditPage_item_create_service_onsuccess_mapping_1"]);
            try {
                item_updateMenuCache_service.execute({});
            } catch (e) {
                console.error(e);
                hideSpinner();
            };
        },
        "onError": function(jqXHR, textStatus, errorThrown) {}
    });
    window.item_read_service = Apperyio.datasources.item_read_service = new Apperyio.DataSource(projectMdb1_item_read_service, {
        "onBeforeSend": function(jqXHR) {
            Apperyio.processMappingAction(Apperyio.mappings["itemEditPage_item_read_service_onbeforesend_mapping_0"]);
        },
        "onComplete": function(jqXHR, textStatus) {
        },
        "onSuccess": function(data) {
            Apperyio.processMappingAction(Apperyio.mappings["itemEditPage_item_read_service_onsuccess_mapping_2"]);
            var proterties = storageGet('tempString');
            if (proterties) {
                Apperyio('propertySelectButton').val(proterties.split(',')).refresh();
            }
            //var list = storageGet('headingSelectList');
            //if(!editMode)
            //{
            //	Apperyio("menuHeadingSelect").val(list[0].id).refresh();
            //    log(list[0]);
            //}
            /*
            if(editMode)
            {
                //log(currentItem);
                if(!currentItem.parent_id)
                {
                    Apperyio("menuHeadingSelect").val(list[0].id).refresh();
                } 
                else
                {
                    Apperyio("menuHeadingSelect").val(currentItem.parent_id).refresh();
                }
            	
            }
            else 
            {
            	Apperyio("menuHeadingSelect").val(list[0].id).refresh();
            }
            */
            ;
        },
        "onError": function(jqXHR, textStatus, errorThrown) {}
    });
    window.item_update_service = Apperyio.datasources.item_update_service = new Apperyio.DataSource(projectMdb1_item_update_service, {
        "onBeforeSend": function(jqXHR) {
            Apperyio.processMappingAction(Apperyio.mappings["itemEditPage_item_update_service_onbeforesend_mapping_0"]);
        },
        "onComplete": function(jqXHR, textStatus) {
        },
        "onSuccess": function(data) {
            var curentItem = storageGet('currentItem');
            addUpdateItem(curentItem);
            item_updateMenuCache_service.execute({});
            var list = storageGet('menuItemsList'); //menuItemsList //menuHierarchyList
            if (list !== undefined) {
                var foundItem = _.find(list, {
                    id: curentItem.id
                });
                var itemIndex = _.indexOf(list, foundItem);
                list[itemIndex] = curentItem;
                storageSet('menuItemsList', list);
                storageSet('menuHierarchyList', []);
            }
            if (imageHasBeenChanged) {
                item_files_delete_service.execute({});
            } else {
                goBack();
            };
            try {
                item_updateMenuCache_service.execute({});
            } catch (e) {
                console.error(e);
                hideSpinner();
            };
        },
        "onError": function(jqXHR, textStatus, errorThrown) {
            log(jqXHR.responseText);
        }
    });
    window.item_map_service = Apperyio.datasources.item_map_service = new Apperyio.DataSource(GenericService, {
        "onBeforeSend": function(jqXHR) {},
        "onComplete": function(jqXHR, textStatus) {
        },
        "onSuccess": function(data) {
            if (!editMode) {
                var maxOrder = _.max(storageGet('menuItemsList'), function(item) {
                    return item.order;
                }).order || 0;
                storageSet('currentItem', {
                    order: ++maxOrder
                });
            };
            Apperyio.processMappingAction(Apperyio.mappings["itemEditPage_item_map_service_onsuccess_mapping_1"]);
            Apperyio.processMappingAction(Apperyio.mappings["itemEditPage_item_map_service_onsuccess_mapping_2"]);
            if (!editMode && !storageGet('selectedParentItem')) {
                var list = storageGet('menuHierarchyList');
                Apperyio("menuHeadingSelect").val(list[0].id).refresh();
            }
            if (editMode) {
                item_property_query_service.execute({});
                item_read_service.execute({});
            };
        },
        "onError": function(jqXHR, textStatus, errorThrown) {}
    });
    window.item_menuHeading_list_service = Apperyio.datasources.item_menuHeading_list_service = new Apperyio.DataSource(projectMdb1_menuHeading_list_service, {
        "onBeforeSend": function(jqXHR) {
            Apperyio.processMappingAction(Apperyio.mappings["itemEditPage_item_menuHeading_list_service_onbeforesend_mapping_0"]);
        },
        "onComplete": function(jqXHR, textStatus) {
        },
        "onSuccess": function(data) {
            Apperyio.processMappingAction(Apperyio.mappings["itemEditPage_item_menuHeading_list_service_onsuccess_mapping_0"]);
            //makeHierarchy();
            item_map_service.execute({});
        },
        "onError": function(jqXHR, textStatus, errorThrown) {}
    });
    window.item_delete_service = Apperyio.datasources.item_delete_service = new Apperyio.DataSource(projectMdb1_item_delete_service, {
        "onBeforeSend": function(jqXHR) {
            Apperyio.processMappingAction(Apperyio.mappings["itemEditPage_item_delete_service_onbeforesend_mapping_0"]);
        },
        "onComplete": function(jqXHR, textStatus) {
        },
        "onSuccess": function(data) {
            Apperyio('deleteConfirmPopup').popup('close');
            storageSet('menuHierarchyList', []);
            goBack();
            try {
                item_updateMenuCache_service.execute({});
            } catch (e) {
                console.error(e);
                hideSpinner();
            };
        },
        "onError": function(jqXHR, textStatus, errorThrown) {}
    });
    window.item_camera = Apperyio.datasources.item_camera = new Apperyio.DataSource(CameraService, {
        "onBeforeSend": function(jqXHR) {
            Apperyio.processMappingAction(Apperyio.mappings["itemEditPage_item_camera_onbeforesend_mapping_0"]);
        },
        "onComplete": function(jqXHR, textStatus) {
        },
        "onSuccess": function(data) {
            Apperyio.processMappingAction(Apperyio.mappings["itemEditPage_item_camera_onsuccess_mapping_0"]);
        },
        "onError": function(jqXHR, textStatus, errorThrown) {
            alert('camera fail');
        }
    });
    window.item_files_upload_service = Apperyio.datasources.item_files_upload_service = new Apperyio.DataSource(projectMdb1__files_upload_service, {
        "onBeforeSend": function(jqXHR) {
            Apperyio.processMappingAction(Apperyio.mappings["itemEditPage_item_files_upload_service_onbeforesend_mapping_0"]);
        },
        "onComplete": function(jqXHR, textStatus) {
        },
        "onSuccess": function(data) {},
        "onError": function(jqXHR, textStatus, errorThrown) {
            log(jqXHR.responseText);
        }
    });
    window.item_property_query_service = Apperyio.datasources.item_property_query_service = new Apperyio.DataSource(projectMdb1_property_query_service, {
        "onBeforeSend": function(jqXHR) {
            Apperyio.processMappingAction(Apperyio.mappings["itemEditPage_item_property_query_service_onbeforesend_mapping_0"]);
        },
        "onComplete": function(jqXHR, textStatus) {
        },
        "onSuccess": function(data) {
            Apperyio.processMappingAction(Apperyio.mappings["itemEditPage_item_property_query_service_onsuccess_mapping_0"]);
        },
        "onError": function(jqXHR, textStatus, errorThrown) {}
    });
    window.item_files_delete_service = Apperyio.datasources.item_files_delete_service = new Apperyio.DataSource(projectMdb1__files_delete_service, {
        "onBeforeSend": function(jqXHR) {
            Apperyio.processMappingAction(Apperyio.mappings["itemEditPage_item_files_delete_service_onbeforesend_mapping_0"]);
        },
        "onComplete": function(jqXHR, textStatus) {
            var imgData = storageGet('imageDataBase64');
            debugger;
            if (imgData) {
                uploadBinaryHelper(item_files_upload_service, storageGet('imageDataBase64'), null, null, item_update_image_service);
            } else {
                storageSet('fileInfo', {
                    fileName: null,
                    originalFileName: null
                });
                item_update_image_service.execute({});
            };
        },
        "onSuccess": function(data) {},
        "onError": function(jqXHR, textStatus, errorThrown) {}
    });
    window.item_update_image_service = Apperyio.datasources.item_update_image_service = new Apperyio.DataSource(projectMdb1_item_update_service, {
        "onBeforeSend": function(jqXHR) {
            Apperyio.processMappingAction(Apperyio.mappings["itemEditPage_item_update_image_service_onbeforesend_mapping_0"]);
        },
        "onComplete": function(jqXHR, textStatus) {
        },
        "onSuccess": function(data) {
            goBack();
        },
        "onError": function(jqXHR, textStatus, errorThrown) {
            alert(jqXHR.responseText);
        }
    });
    window.item_getMenuHierarchy_service = Apperyio.datasources.item_getMenuHierarchy_service = new Apperyio.DataSource(getMenuHierarchy_service, {
        "onBeforeSend": function(jqXHR) {
            Apperyio.processMappingAction(Apperyio.mappings["itemEditPage_item_getMenuHierarchy_service_onbeforesend_mapping_0"]);
        },
        "onComplete": function(jqXHR, textStatus) {
        },
        "onSuccess": function(data) {
            data = data.sort(function(a, b) {
                if (a.heading < b.heading) return -1
                else if (a.heading > b.heading) return 1
                else return 0
            });
            Apperyio.processMappingAction(Apperyio.mappings["itemEditPage_item_getMenuHierarchy_service_onsuccess_mapping_1"]);
            if (!editMode) {
                var maxOrder = _.max(storageGet('menuItemsList'), function(item) {
                    return item.order;
                }).order || 0;
                storageSet('currentItem', {
                    order: ++maxOrder
                });
            }
            //if(!editMode && !storageGet('selectedParentItem')) 
            //{
            //	var list = storageGet('menuHierarchyList');
            //	Apperyio("menuHeadingSelect").val(list[0].id).refresh();
            //}
            if (editMode) {
                item_property_query_service.execute({});
                item_read_service.execute({});
            };
        },
        "onError": function(jqXHR, textStatus, errorThrown) {}
    });
    window.item_updateMenuCache_service = Apperyio.datasources.item_updateMenuCache_service = new Apperyio.DataSource(updateMenuCache_service, {
        "onBeforeSend": function(jqXHR) {
            Apperyio.processMappingAction(Apperyio.mappings["itemEditPage_item_updateMenuCache_service_onbeforesend_mapping_0"]);
        },
        "onComplete": function(jqXHR, textStatus) {
        },
        "onSuccess": function(data) {
            Apperyio.processMappingAction(Apperyio.mappings["itemEditPage_item_updateMenuCache_service_onsuccess_mapping_0"]);
            console.log("menu cache updated");
        },
        "onError": function(jqXHR, textStatus, errorThrown) {}
    });
    Apperyio.CurrentScreen = 'itemEditPage';
    _.chain(Apperyio.mappings)
        .filter(function(m) {
            return m.homeScreen === Apperyio.CurrentScreen;
        })
        .each(Apperyio.UIHandler.hideTemplateComponents);
    /*
     * Events and handlers
     */
    // On Load
    var itemEditPage_onLoad = function() {
        itemEditPage_elementsExtraJS();
        imageHasBeenChanged = false;
        /*
        _.each(['itemNameField', 'itemDescriptionField', 'itemPriceField'], function(value){
            Apperyio(value).val('');
        });
        */
        storageSet('fileInfo', null);
        item_getMenuHierarchy_service.execute({});
        /*
        var list = storageGet('headingSelectList');
        if(!list || !list.length)
        {
            item_menuHeading_list_service.execute({});
        } 
        else 
        {
        	item_map_service.execute({});
        }
        */
        ;
        itemEditPage_deviceEvents();
        itemEditPage_windowEvents();
        itemEditPage_elementsEvents();
    };
    // screen window events
    function itemEditPage_windowEvents() {
        $('#itemEditPage').bind('pageshow orientationchange', function() {
            var _page = this;
            adjustContentHeightWithPadding(_page);
        });
        $('#itemEditPage').on({
            pageshow: function(event) {
                storageSet('itemPrefs', storageGet('currentItem').includePrefs);
                buildMultiPrefsDropdown(Apperyio('html_multiselect'), 'itemEditPage_selectPrefs', 'itemPrefs');
            },
        });
    };
    // device events
    function itemEditPage_deviceEvents() {
        document.addEventListener("deviceready", function() {
        });
    };
    // screen elements extra js
    function itemEditPage_elementsExtraJS() {
        // screen (itemEditPage) extra code
        /* unavailableItemToggle */
        $("#itemEditPage_unavailableItemToggle").parent().find(".ui-flipswitch-on").attr("tabindex", "1");
        /* inactiveToggle */
        $("#itemEditPage_inactiveToggle").parent().find(".ui-flipswitch-on").attr("tabindex", "2");
        /* menuHeadingSelect */
        $("#itemEditPage_menuHeadingSelect").parent().find("a.ui-btn").attr("tabindex", "13");
        /* classificationSelect */
        $("#itemEditPage_classificationSelect").parent().find("a.ui-btn").attr("tabindex", "29");
        /* propertySelectButton */
        $("#itemEditPage_propertySelectButton").parent().find("a.ui-btn").attr("tabindex", "28");
        /* pairingSelectButton */
        $("#itemEditPage_pairingSelectButton").parent().find("a.ui-btn").attr("tabindex", "33");
        /* timeRangeSelect */
        $("#itemEditPage_timeRangeSelect").parent().find("a.ui-btn").attr("tabindex", "15");
        /* ingredientAddPopup */
        $("#itemEditPage_ingredientAddPopup").popup("option", "positionTo", "window");
        /* cooktechSelect */
        $("#itemEditPage_cooktechSelect").parent().find("a.ui-btn").attr("tabindex", "21");
        /* mobileselectmenu_24 */
        $("#itemEditPage_mobileselectmenu_24").parent().find("a.ui-btn").attr("tabindex", "22");
        /* deleteConfirmPopup */
        $("#itemEditPage_deleteConfirmPopup").popup("option", "positionTo", "window");
        /* deletePhotoConfirmPopup */
        $("#itemEditPage_deletePhotoConfirmPopup").popup("option", "positionTo", "window");
    };
    // screen elements handler
    function itemEditPage_elementsEvents() {
        $(document).on("click", "a :input,a a,a fieldset label", function(event) {
            event.stopPropagation();
        });
        $(document).off("click", '#itemEditPage_dishEditHeader [name="homeButton"]').on({
            click: function(event) {
                if (!$(this).attr('disabled')) {
                    Apperyio.navigateTo('proprietorStartPage', {
                        transition: 'slidedown',
                        reverse: false
                    });
                }
            },
        }, '#itemEditPage_dishEditHeader [name="homeButton"]');
        $(document).off("change", '#itemEditPage_editDishContainer [name="fileSelect"]').on({
            change: function(event) {
                var callback = function(event) {
                    var previewContainer = Apperyio('itemPhoto');
                    previewContainer.attr('src', event.target.result);
                    Apperyio('itemImageGrid').show();
                };
                // var reader = new FileReader();
                // reader.readAsDataURL(arguments[0]);
                // reader.onload = function(e) {
                //     // browser completed reading file - display it
                //     setFileToUpload(event.target.result);
                // };
                imageHasBeenChanged = true;
                previewFile(arguments[0], callback);
            },
        }, '#itemEditPage_editDishContainer [name="fileSelect"]');
        $(document).off("click", '#itemEditPage_editDishContainer [name="photoAddButton"]').on({
            click: function(event) {
                if (!$(this).attr('disabled')) {
                    Apperyio('fileSelect').click();
                    return false;
                }
            },
        }, '#itemEditPage_editDishContainer [name="photoAddButton"]');
        $(document).off("click", '#itemEditPage_editDishContainer [name="photoDeleteButton"]').on({
            click: function(event) {
                if (!$(this).attr('disabled')) {
                    imageHasBeenChanged = true;
                    var previewContainer = Apperyio('itemPhoto');
                    previewContainer.attr('src', 'http://appery.io/app/view/6f6b5cb3-e481-4b12-be3f-dd8cecd1ca07/libs/apperyio/img/no-image.jpg');
                    storageSet('imageDataBase64', '');
                    Apperyio('itemImageGrid').hide();
                }
            },
        }, '#itemEditPage_editDishContainer [name="photoDeleteButton"]');
        $(document).off("click", '#itemEditPage_editDishContainer [name="itemEditSaveButton"]').on({
            click: function(event) {
                if (!$(this).attr('disabled')) {
                    if (editMode) {
                        item_update_service.execute({});
                    } else {
                        item_create_service.execute({});
                    };
                }
            },
        }, '#itemEditPage_editDishContainer [name="itemEditSaveButton"]');
        $(document).off("click", '#itemEditPage_editDishContainer [name="deleteButton"]').on({
            click: function(event) {
                if (!$(this).attr('disabled')) {
                    var popupElement = Apperyio("deleteConfirmPopup");
                    if (popupElement.popup("option", "positionTo") === "origin") {
                        popupElement.popup("open", {
                            transition: "pop",
                            positionTo: "#" + $(this).attr("id")
                        });
                    } else {
                        popupElement.popup("open", {
                            transition: "pop"
                        });
                    };
                }
            },
        }, '#itemEditPage_editDishContainer [name="deleteButton"]');
        $(document).off("click", '#itemEditPage_editDishContainer [name="cancelButton"]').on({
            click: function(event) {
                if (!$(this).attr('disabled')) {
                    goBack();
                }
            },
        }, '#itemEditPage_editDishContainer [name="cancelButton"]');
        $(document).off("click", '#itemEditPage_ingredientAddPopup [name="ingredientAddSaveButton"]').on({
            click: function(event) {
                if (!$(this).attr('disabled')) {
                    Apperyio('ingredientAddPopup').popup('close');
                }
            },
        }, '#itemEditPage_ingredientAddPopup [name="ingredientAddSaveButton"]');
        $(document).off("click", '#itemEditPage_ingredientAddPopup [name="ingredientAddCancelButton"]').on({
            click: function(event) {
                if (!$(this).attr('disabled')) {
                    Apperyio('deleteConfirmPopup').popup('close');
                }
            },
        }, '#itemEditPage_ingredientAddPopup [name="ingredientAddCancelButton"]');
        $(document).off("click", '#itemEditPage_deleteConfirmPopup [name="deleteConfirmButton"]').on({
            click: function(event) {
                if (!$(this).attr('disabled')) {
                    try {
                        item_delete_service.execute({});
                    } catch (e) {
                        console.error(e);
                        hideSpinner();
                    };
                }
            },
        }, '#itemEditPage_deleteConfirmPopup [name="deleteConfirmButton"]');
        $(document).off("click", '#itemEditPage_deleteConfirmPopup [name="deleteCancelButton"]').on({
            click: function(event) {
                if (!$(this).attr('disabled')) {
                    Apperyio('deleteConfirmPopup').popup('close');
                }
            },
        }, '#itemEditPage_deleteConfirmPopup [name="deleteCancelButton"]');
        $(document).off("click", '#itemEditPage_deletePhotoConfirmPopup [name="deletePhotoCancelButton"]').on({
            click: function(event) {
                if (!$(this).attr('disabled')) {
                    Apperyio('deletePhotoConfirmPopup').popup('close');
                }
            },
        }, '#itemEditPage_deletePhotoConfirmPopup [name="deletePhotoCancelButton"]');
    };
    $(document).off("pagebeforeshow", "#itemEditPage").on("pagebeforeshow", "#itemEditPage", function(event, ui) {
        Apperyio.CurrentScreen = "itemEditPage";
        _.chain(Apperyio.mappings)
            .filter(function(m) {
                return m.homeScreen === Apperyio.CurrentScreen;
            })
            .each(Apperyio.UIHandler.hideTemplateComponents);
    });
    itemEditPage_onLoad();
};
$(document).off("pagecreate", "#itemEditPage").on("pagecreate", "#itemEditPage", function(event, ui) {
    Apperyio.processSelectMenu($(this));
    itemEditPage_js();
});