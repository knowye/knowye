/*
 * JS for navigatePage generated by Appery.io
 */
Apperyio.getProjectGUID = function() {
    return '148444cb-eb26-4cec-bc22-29bf794bc529';
};

function navigateTo(outcome, useAjax) {
    Apperyio.navigateTo(outcome, useAjax);
}

function adjustContentHeight() {
    Apperyio.adjustContentHeightWithPadding();
}

function adjustContentHeightWithPadding(_page) {
    Apperyio.adjustContentHeightWithPadding(_page);
}

function setDetailContent(pageUrl) {
    Apperyio.setDetailContent(pageUrl);
}
Apperyio.AppPages = [{
    "name": "aboutPage",
    "location": "aboutPage.html"
}, {
    "name": "itemDetailsPage",
    "location": "itemDetailsPage.html"
}, {
    "name": "menuHeadingManagePage",
    "location": "menuHeadingManagePage.html"
}, {
    "name": "proprietorAnalyticsPage",
    "location": "proprietorAnalyticsPage.html"
}, {
    "name": "zzpromoEdit",
    "location": "zzpromoEdit.html"
}, {
    "name": "startScreen",
    "location": "startScreen.html"
}, {
    "name": "itemPage",
    "location": "itemPage.html"
}, {
    "name": "zzpromoManage",
    "location": "zzpromoManage.html"
}, {
    "name": "zzscannerPage",
    "location": "zzscannerPage.html"
}, {
    "name": "zztimeRangePage",
    "location": "zztimeRangePage.html"
}, {
    "name": "selectedPage",
    "location": "selectedPage.html"
}, {
    "name": "zzCSStestPage",
    "location": "zzCSStestPage.html"
}, {
    "name": "zzmenuPage",
    "location": "zzmenuPage.html"
}, {
    "name": "menuHistoryPage",
    "location": "menuHistoryPage.html"
}, {
    "name": "faqPage",
    "location": "faqPage.html"
}, {
    "name": "zzratingInfoPage",
    "location": "zzratingInfoPage.html"
}, {
    "name": "orderHistoryPage",
    "location": "orderHistoryPage.html"
}, {
    "name": "createAccount",
    "location": "createAccount.html"
}, {
    "name": "itemManagePage",
    "location": "itemManagePage.html"
}, {
    "name": "proprietorStartPage",
    "location": "proprietorStartPage.html"
}, {
    "name": "operationsRestaurantPage",
    "location": "operationsRestaurantPage.html"
}, {
    "name": "zzdetailedReviewPage",
    "location": "zzdetailedReviewPage.html"
}, {
    "name": "itemEditPage",
    "location": "itemEditPage.html"
}, {
    "name": "selectionHistoryPage",
    "location": "selectionHistoryPage.html"
}, {
    "name": "zzproprietorStatPage",
    "location": "zzproprietorStatPage.html"
}, {
    "name": "zzitemInventoryPage",
    "location": "zzitemInventoryPage.html"
}, {
    "name": "zzalertPage",
    "location": "zzalertPage.html"
}, {
    "name": "zzsearchPage",
    "location": "zzsearchPage.html"
}, {
    "name": "menuPage_v2",
    "location": "menuPage_v2.html"
}, {
    "name": "zzqrCodePage",
    "location": "zzqrCodePage.html"
}, {
    "name": "profilePage",
    "location": "profilePage.html"
}, {
    "name": "filterPage",
    "location": "filterPage.html"
}, {
    "name": "easterEggPage",
    "location": "easterEggPage.html"
}, {
    "name": "helpPage",
    "location": "helpPage.html"
}, {
    "name": "navigatePage",
    "location": "navigatePage.html"
}, {
    "name": "menuPreviewPage",
    "location": "menuPreviewPage.html"
}, {
    "name": "zzfacebookLogin",
    "location": "zzfacebookLogin.html"
}, {
    "name": "menu_shared",
    "location": "menu_shared.html"
}, {
    "name": "logoutPage",
    "location": "logoutPage.html"
}, {
    "name": "favoritesPage",
    "location": "favoritesPage.html"
}, {
    "name": "proprietorPage",
    "location": "proprietorPage.html"
}, {
    "name": "wishListPage",
    "location": "wishListPage.html"
}, {
    "name": "menuManagementPage",
    "location": "menuManagementPage.html"
}, {
    "name": "touPage",
    "location": "touPage.html"
}, {
    "name": "zzsettingsPage",
    "location": "zzsettingsPage.html"
}];


function navigatePage_js() {
    /* Object & array with components "name-to-id" mapping */
    var n2id_buf = {
        'homeButton': 'navigatePage_homeButton',
        'navigateList': 'navigatePage_navigateList',
        'nearbyButton': 'navigatePage_nearbyButton',
        'mobilelistitembutton_43': 'navigatePage_mobilelistitembutton_43',
        'scanCodeButton': 'navigatePage_scanCodeButton',
        'mobilelistitembutton_18': 'navigatePage_mobilelistitembutton_18',
        'currentSelectionsButton': 'navigatePage_currentSelectionsButton',
        'mobilelistitembutton_45': 'navigatePage_mobilelistitembutton_45',
        'menuHistoryButton': 'navigatePage_menuHistoryButton',
        'mobilelistitembutton_23': 'navigatePage_mobilelistitembutton_23',
        'favoritesButton': 'navigatePage_favoritesButton',
        'mobilelistitembutton_12': 'navigatePage_mobilelistitembutton_12',
        'wishListButton': 'navigatePage_wishListButton',
        'mobilelistitembutton_14': 'navigatePage_mobilelistitembutton_14',
        'orderHistoryButton': 'navigatePage_orderHistoryButton',
        'mobilelistitembutton_21': 'navigatePage_mobilelistitembutton_21',
        'searchPageReturnButton': 'navigatePage_searchPageReturnButton',
        'mobilelistitembutton_10': 'navigatePage_mobilelistitembutton_10',
        'updateProfileButton': 'navigatePage_updateProfileButton',
        'mobilelistitembutton_4': 'navigatePage_mobilelistitembutton_4',
        'settingsButton': 'navigatePage_settingsButton',
        'mobilelistitembutton_16': 'navigatePage_mobilelistitembutton_16',
        'helpButton': 'navigatePage_helpButton',
        'mobilelistitembutton_6': 'navigatePage_mobilelistitembutton_6',
        'ratingInfoPageButton': 'navigatePage_ratingInfoPageButton',
        'mobilelistitembutton_26': 'navigatePage_mobilelistitembutton_26',
        'logoutButton': 'navigatePage_logoutButton',
        'mobilelistitembutton_8': 'navigatePage_mobilelistitembutton_8',
        'loggedInLabel': 'navigatePage_loggedInLabel',
        'loggedInIdLabel': 'navigatePage_loggedInIdLabel',
        'vendotOptionsButton': 'navigatePage_vendotOptionsButton',
        'logoutConfirmLabel': 'navigatePage_logoutConfirmLabel',
        'logoutPopupButtonGrid': 'navigatePage_logoutPopupButtonGrid',
        'logoutPopupConfirmCell': 'navigatePage_logoutPopupConfirmCell',
        'logoutConfirmButton': 'navigatePage_logoutConfirmButton',
        'logoutPopupCancelCell': 'navigatePage_logoutPopupCancelCell',
        'logoutCancelButton': 'navigatePage_logoutCancelButton',
        'loginGotoLabel': 'navigatePage_loginGotoLabel',
        'loginGotoButtonGrid': 'navigatePage_loginGotoButtonGrid',
        'loginGotoCell': 'navigatePage_loginGotoCell',
        'loginGotoButton': 'navigatePage_loginGotoButton',
        'loginGotoCancelCell': 'navigatePage_loginGotoCancelCell',
        'loginGotoCancelButton': 'navigatePage_loginGotoCancelButton',
        'quickMessageLabel': 'navigatePage_quickMessageLabel',
        'locationPopupGrid': 'navigatePage_locationPopupGrid',
        'cancelButtonCell': 'navigatePage_cancelButtonCell',
        'locationCancelButton': 'navigatePage_locationCancelButton',
        'labelCell': 'navigatePage_labelCell',
        'locationPopupLabel': 'navigatePage_locationPopupLabel',
        'featureLocationList': 'navigatePage_featureLocationList',
        'featureLocationListItem': 'navigatePage_featureLocationListItem',
        'mobilelistitembutton_48': 'navigatePage_mobilelistitembutton_48',
        'locationList': 'navigatePage_locationList',
        'locationItem': 'navigatePage_locationItem',
        'mobilelistitembutton_31': 'navigatePage_mobilelistitembutton_31'
    };
    if ("n2id" in window && window.n2id !== undefined) {
        $.extend(n2id, n2id_buf);
    } else {
        window.n2id = n2id_buf;
    }
    /*
     * Nonvisual components
     */
    Apperyio.mappings = Apperyio.mappings || {};
    Apperyio.mappings["navigatePage_navigatePage_onload_mapping_0"] = {
        "homeScreen": "navigatePage",
        "directions": [
            {
                "from_name": "userName",
                "from_type": "SESSION_STORAGE",
                "to_name": "navigatePage",
                "to_type": "UI",
                "mappings": [
                    {
                        "source": "$",
                        "target": "$['loggedInIdLabel:text']"
                    }
                ]
            }
        ]
    };
    Apperyio.mappings["navigatePage_navigatePage_logout_service_onbeforesend_mapping_0"] = {
        "homeScreen": "navigatePage",
        "directions": [
            {
                "to_name": "navigatePage_logout_service",
                "to_type": "SERVICE_REQUEST",
                "to_default": {
                    "headers": {
                        "X-Appery-Database-Id": "{database_id}",
                        "X-Appery-Session-Token": "{session_token}"
                    },
                    "parameters": {},
                    "body": null
                },
                "mappings": []
            }
        ]
    };
    Apperyio.mappings["navigatePage_navigatePage_mobilebarcode_onbeforesend_mapping_0"] = {
        "homeScreen": "navigatePage",
        "directions": []
    };
    Apperyio.mappings["navigatePage_navigatePage_vendor_read_service_onsuccess_mapping_0"] = {
        "homeScreen": "navigatePage",
        "directions": []
    };
    Apperyio.mappings["navigatePage_navigatePage_vendor_read_service_onbeforesend_mapping_0"] = {
        "homeScreen": "navigatePage",
        "directions": [
            {
                "from_name": "vendorId",
                "from_type": "SESSION_STORAGE",
                "to_name": "navigatePage_vendor_read_service",
                "to_type": "SERVICE_REQUEST",
                "to_default": {
                    "headers": {
                        "X-Appery-Database-Id": "{database_id}"
                    },
                    "parameters": {
                        "include": "state,country"
                    },
                    "body": null
                },
                "mappings": [
                    {
                        "source": "$",
                        "target": "$['parameters']['_id']"
                    }
                ]
            }
        ]
    };
    Apperyio.mappings["navigatePage_navigatePage_menuHistory_query_service_onsuccess_mapping_0"] = {
        "homeScreen": "navigatePage",
        "directions": []
    };
    Apperyio.mappings["navigatePage_navigatePage_menuHistory_query_service_onbeforesend_mapping_0"] = {
        "homeScreen": "navigatePage",
        "directions": [
            {
                "to_name": "navigatePage_menuHistory_query_service",
                "to_type": "SERVICE_REQUEST",
                "to_default": {
                    "headers": {
                        "X-Appery-Database-Id": "{database_id}",
                        "X-Appery-Session-Token": "{session_token}"
                    },
                    "parameters": {
                        "include": "vendor,vendor.state,vendor.country",
                        "sort": "date"
                    },
                    "body": null
                },
                "mappings": []
            }
        ]
    };
    Apperyio.mappings["navigatePage_navigatePage_setMenuHistory_service_onbeforesend_mapping_0"] = {
        "homeScreen": "navigatePage",
        "directions": [
            {
                "from_name": "userId",
                "from_type": "LOCAL_STORAGE",
                "to_name": "navigatePage_setMenuHistory_service",
                "to_type": "SERVICE_REQUEST",
                "to_default": {
                    "headers": {
                        "Content-Type": "text/plain"
                    },
                    "parameters": {
                        "user_id": "56dff9d2e4b07fb4837fc810",
                        "vendor_id": "567bc758e4b0efe9f5f7c579"
                    },
                    "body": null
                },
                "mappings": [
                    {
                        "source": "$",
                        "target": "$['parameters']['user_id']"
                    }
                ]
            },
            {
                "from_name": "vendorId",
                "from_type": "SESSION_STORAGE",
                "to_name": "navigatePage_setMenuHistory_service",
                "to_type": "SERVICE_REQUEST",
                "to_default": {
                    "headers": {
                        "Content-Type": "text/plain"
                    },
                    "parameters": {
                        "user_id": "56dff9d2e4b07fb4837fc810",
                        "vendor_id": "567bc758e4b0efe9f5f7c579"
                    },
                    "body": null
                },
                "mappings": [
                    {
                        "source": "$",
                        "target": "$['parameters']['vendor_id']"
                    }
                ]
            },
            {
                "to_name": "navigatePage_setMenuHistory_service",
                "to_type": "SERVICE_REQUEST",
                "to_default": {
                    "headers": {
                        "Content-Type": "text/plain"
                    },
                    "parameters": {
                        "user_id": "56dff9d2e4b07fb4837fc810",
                        "vendor_id": "567bc758e4b0efe9f5f7c579"
                    },
                    "body": null
                },
                "mappings": [
                    {
                        "target_transformation": function(value) {
                            return (new Date()).getTime();
                        },
                        "target": "$['parameters']['timestamp']"
                    }
                ]
            }
        ]
    };
    Apperyio.mappings["navigatePage_navigatePape_clearOrder_service_onbeforesend_mapping_0"] = {
        "homeScreen": "navigatePage",
        "directions": [
            {
                "to_name": "navigatePape_clearOrder_service",
                "to_type": "SERVICE_REQUEST",
                "to_default": {
                    "headers": {
                        "Content-Type": "text/plain"
                    },
                    "parameters": {},
                    "body": null
                },
                "mappings": []
            }
        ]
    };
    Apperyio.mappings["navigatePage_navigatePage_geolocation_service_onsuccess_mapping_0"] = {
        "homeScreen": "navigatePage",
        "directions": [
            {
                "from_name": "navigatePage_geolocation_service",
                "from_type": "SERVICE_RESPONSE",
                "to_name": "coords",
                "to_type": "SESSION_STORAGE",
                "mappings": [
                    {
                        "source": "$['data']['coords']['latitude']",
                        "target": "$['Latitude']"
                    },
                    {
                        "source": "$['data']['coords']['longitude']",
                        "target": "$['Longitude']"
                    }
                ]
            }
        ]
    };
    Apperyio.mappings["navigatePage_navigatePage_geolocation_service_onbeforesend_mapping_0"] = {
        "homeScreen": "navigatePage",
        "directions": [
            {
                "to_name": "navigatePage_geolocation_service",
                "to_type": "SERVICE_REQUEST",
                "to_default": {
                    "data": {
                        "options": {
                            "maximumAge": 3000,
                            "timeout": 9999,
                            "enableHighAccuracy": true,
                            "watchPosition": false
                        }
                    }
                },
                "mappings": []
            }
        ]
    };
    Apperyio.mappings["navigatePage_navigatePage_findNearestVendors_service_onsuccess_mapping_1"] = {
        "homeScreen": "navigatePage",
        "directions": [
            {
                "from_name": "navigatePage_findNearestVendors_service",
                "from_type": "SERVICE_RESPONSE",
                "to_name": "navigatePage",
                "to_type": "UI",
                "mappings": [
                    {
                        "source": "$['body'][i]",
                        "target": "$['locationItem']"
                    },
                    {
                        "source": "$['body'][i]['businessName']",
                        "target": "$['locationItem:text']"
                    },
                    {
                        "source": "$['body'][i]['distance']",
                        "target_transformation": function(value, element) {
                            return value + ' miles';
                        },
                        "target": "$['locationItem:counter_value']"
                    }
                ]
            }
        ]
    };
    Apperyio.mappings["navigatePage_navigatePage_findNearestVendors_service_onbeforesend_mapping_0"] = {
        "homeScreen": "navigatePage",
        "directions": [
            {
                "to_name": "navigatePage_findNearestVendors_service",
                "to_type": "SERVICE_REQUEST",
                "to_default": {
                    "headers": {
                        "X-Appery-Database-Id": "{database_id}"
                    },
                    "parameters": {
                        "include": "state,country",
                        "limit": "1000",
                        "sort": "_id"
                    },
                    "body": null
                },
                "mappings": [
                    {
                        "target_transformation": function(value) {
                            var c = storageGet('coords');
                            // DEBUG
                            // c = { Latitude: 40.7561241, Longitude: -73.9847552 }; 
                            return JSON.stringify({
                                "featuredDate": null,
                                "disabled": {
                                    "$ne": true
                                },
                                "coords": {
                                    "$nearSphere": [c.Longitude, c.Latitude],
                                    "$maxDistanceInKilometers": 5000
                                }
                            });
                        },
                        "target": "$['parameters']['where']"
                    }
                ]
            }
        ]
    };
    Apperyio.mappings["navigatePage_navigatePage_findFeaturedVendors_service_onbeforesend_mapping_0"] = {
        "homeScreen": "navigatePage",
        "directions": [
            {
                "to_name": "navigatePage_findFeaturedVendors_service",
                "to_type": "SERVICE_REQUEST",
                "to_default": {
                    "headers": {
                        "X-Appery-Database-Id": "{database_id}"
                    },
                    "parameters": {
                        "include": "state,country",
                        "limit": "1",
                        "sort": "-featuredDate"
                    },
                    "body": null
                },
                "mappings": []
            }
        ]
    };
    Apperyio.mappings["navigatePage_navigatePage_findFeaturedVendors_service_onsuccess_mapping_1"] = {
        "homeScreen": "navigatePage",
        "directions": [
            {
                "from_name": "navigatePage_findFeaturedVendors_service",
                "from_type": "SERVICE_RESPONSE",
                "to_name": "navigatePage",
                "to_type": "UI",
                "mappings": [
                    {
                        "source": "$['body'][i]",
                        "target": "$['featureLocationListItem']"
                    },
                    {
                        "source": "$['body'][i]['distance']",
                        "target_transformation": function(value, element) {
                            return "featured";
                        },
                        "target": "$['featureLocationListItem:counter_value']"
                    },
                    {
                        "source": "$['body'][i]['businessName']",
                        "target": "$['featureLocationListItem:text']"
                    }
                ]
            }
        ]
    };
    Apperyio.datasources = Apperyio.datasources || {};
    window.navigatePage_logout_service = Apperyio.datasources.navigatePage_logout_service = new Apperyio.DataSource(projectMdb1_logout_service, {
        "onBeforeSend": function(jqXHR) {
            Apperyio.processMappingAction(Apperyio.mappings["navigatePage_navigatePage_logout_service_onbeforesend_mapping_0"]);
        },
        "onComplete": function(jqXHR, textStatus) {
            navigatePageManager.navigatePage_logout_service_onSuccess({});
        },
        "onSuccess": function(data) {},
        "onError": function(jqXHR, textStatus, errorThrown) {}
    });
    window.navigatePage_mobilebarcode = Apperyio.datasources.navigatePage_mobilebarcode = new Apperyio.DataSource(zzBarcodeService, {
        "onBeforeSend": function(jqXHR) {
            Apperyio.processMappingAction(Apperyio.mappings["navigatePage_navigatePage_mobilebarcode_onbeforesend_mapping_0"]);
        },
        "onComplete": function(jqXHR, textStatus) {
        },
        "onSuccess": function(data) {
            projectMdb1_settings.vendor_id = null;
            storageSet('menuHeading', null);
            var vendor_id = urlParam('vendor', data.text);
            if (vendor_id) {
                if (projectMdb1_settings.vendor_id !== vendor_id) {
                    //if(projectMdb1_settings.vendor_id)
                    //{
                    //	var clearOrder = true;
                    //}
                    projectMdb1_settings.vendor_id = vendor_id;
                    storageSet('vendorId', vendor_id);
                    //navigatePage_vendor_read_service.execute({});      
                    //if(clearOrder)
                    //{
                    //	navigatePape_clearOrder_service.execute({});
                    //}
                    //else
                    //{
                    navigatePage_vendor_read_service.execute({});
                    //}
                }
            } else {
                navigator.notification.alert("Oops, I didn't see a QR code", null, "Problem");
            };
        },
        "onError": function(jqXHR, textStatus, errorThrown) {
            navigator.notification.alert("Oops, I didn't see a QR code", null, "Problem");
        }
    });
    window.navigatePage_vendor_read_service = Apperyio.datasources.navigatePage_vendor_read_service = new Apperyio.DataSource(projectMdb1_vendor_read_service, {
        "onBeforeSend": function(jqXHR) {
            Apperyio.processMappingAction(Apperyio.mappings["navigatePage_navigatePage_vendor_read_service_onbeforesend_mapping_0"]);
        },
        "onComplete": function(jqXHR, textStatus) {
        },
        "onSuccess": function(data) {
            Apperyio.processMappingAction(Apperyio.mappings["navigatePage_navigatePage_vendor_read_service_onsuccess_mapping_0"]);
            try {
                navigatePage_setMenuHistory_service.execute({});
            } catch (e) {
                console.error(e);
                hideSpinner();
            };
        },
        "onError": function(jqXHR, textStatus, errorThrown) {
            Apperyio.navigateTo('startScreen', {
                reverse: false
            });
        }
    });
    window.navigatePage_menuHistory_query_service = Apperyio.datasources.navigatePage_menuHistory_query_service = new Apperyio.DataSource(projectMdb1_menuHistory_query_service, {
        "onBeforeSend": function(jqXHR) {
            Apperyio.processMappingAction(Apperyio.mappings["navigatePage_navigatePage_menuHistory_query_service_onbeforesend_mapping_0"]);
        },
        "onComplete": function(jqXHR, textStatus) {
        },
        "onSuccess": function(data) {
            Apperyio.processMappingAction(Apperyio.mappings["navigatePage_navigatePage_menuHistory_query_service_onsuccess_mapping_0"]);
        },
        "onError": function(jqXHR, textStatus, errorThrown) {
            Apperyio.navigateTo('startScreen', {
                reverse: false
            });
        }
    });
    window.navigatePage_setMenuHistory_service = Apperyio.datasources.navigatePage_setMenuHistory_service = new Apperyio.DataSource(setMenuHistory_service, {
        "onBeforeSend": function(jqXHR) {
            Apperyio.processMappingAction(Apperyio.mappings["navigatePage_navigatePage_setMenuHistory_service_onbeforesend_mapping_0"]);
        },
        "onComplete": function(jqXHR, textStatus) {
        },
        "onSuccess": function(data) {
            if (customerMode) {
                Appery.navigateTo('menuPage_v2');
            } else {
                Appery.navigateTo('proprietorStartPage');
            };
        },
        "onError": function(jqXHR, textStatus, errorThrown) {
            Apperyio.navigateTo('startScreen', {
                reverse: false
            });
        }
    });
    window.navigatePape_clearOrder_service = Apperyio.datasources.navigatePape_clearOrder_service = new Apperyio.DataSource(clearOrder_service, {
        "onBeforeSend": function(jqXHR) {
            Apperyio.processMappingAction(Apperyio.mappings["navigatePage_navigatePape_clearOrder_service_onbeforesend_mapping_0"]);
        },
        "onComplete": function(jqXHR, textStatus) {
        },
        "onSuccess": function(data) {
            try {
                navigatePage_vendor_read_service.execute({});
            } catch (e) {
                console.error(e);
                hideSpinner();
            };
        },
        "onError": function(jqXHR, textStatus, errorThrown) {
            Apperyio.navigateTo('startScreen', {
                reverse: false
            });
        }
    });
    window.navigatePage_geolocation_service = Apperyio.datasources.navigatePage_geolocation_service = new Apperyio.DataSource(GeolocationService, {
        "onBeforeSend": function(jqXHR) {
            Apperyio.processMappingAction(Apperyio.mappings["navigatePage_navigatePage_geolocation_service_onbeforesend_mapping_0"]);
            try {
                navigatePage_findFeaturedVendors_service.execute({});
            } catch (e) {
                console.error(e);
                hideSpinner();
            };
        },
        "onComplete": function(jqXHR, textStatus) {
        },
        "onSuccess": function(data) {
            Apperyio.processMappingAction(Apperyio.mappings["navigatePage_navigatePage_geolocation_service_onsuccess_mapping_0"]);
            try {
                navigatePage_findNearestVendors_service.execute({});
            } catch (e) {
                console.error(e);
                hideSpinner();
            };
        },
        "onError": function(jqXHR, textStatus, errorThrown) {
            var error = arguments[2];
            if (error.code == 1) {
                alertMsg(error.message, 'Please turn on your location service to use this feature.');
            } else {
                alertMsg('Geolocation error', error.message);
            };
        }
    });
    window.navigatePage_findNearestVendors_service = Apperyio.datasources.navigatePage_findNearestVendors_service = new Apperyio.DataSource(projectMdb1_vendor_query_service, {
        "onBeforeSend": function(jqXHR) {
            Apperyio.processMappingAction(Apperyio.mappings["navigatePage_navigatePage_findNearestVendors_service_onbeforesend_mapping_0"]);
        },
        "onComplete": function(jqXHR, textStatus) {
        },
        "onSuccess": function(data) {
           
            var c = storageGet('coords');
            data.forEach(function(item) {
                var d = getDistance({
                    lat: c.Latitude,
                    lng: c.Longitude
                }, {
                    lat: item.coords[1],
                    lng: item.coords[0]
                });
                item.distance = (d * 0.000621371).toFixed(1);
            });
            data = data.sort(function(a, b) {
                return a.distance - b.distance;
            });
            data = data.slice(0, MAX_RESTRAUNTS_TO_SHOW);
            window.navigatePage_findNearestVendors = data;
            
            Apperyio.datasources["navigatePage_findNearestVendors_service"].response = {body: window.navigatePage_findNearestVendors};
            
            Apperyio.processMappingAction(Apperyio.mappings["navigatePage_navigatePage_findNearestVendors_service_onsuccess_mapping_1"]);
            var popupElement = Apperyio("locationPopup");
            if (popupElement.popup("option", "positionTo") === "origin") {
                popupElement.popup("open", {
                    transition: "none",
                    positionTo: "#" + $(this).attr("id")
                });
            } else {
                popupElement.popup("open", {
                    transition: "none"
                });
            };
        },
        "onError": function(jqXHR, textStatus, errorThrown) {
            Apperyio.navigateTo('startScreen', {
                reverse: false
            });
        }
    });
    window.navigatePage_findFeaturedVendors_service = Apperyio.datasources.navigatePage_findFeaturedVendors_service = new Apperyio.DataSource(projectMdb1_vendor_query_service, {
        "onBeforeSend": function(jqXHR) {
            Apperyio.processMappingAction(Apperyio.mappings["navigatePage_navigatePage_findFeaturedVendors_service_onbeforesend_mapping_0"]);
        },
        "onComplete": function(jqXHR, textStatus) {
        },
        "onSuccess": function(data) {
            window.navigatePage_findFeaturedVendors = data;
            Apperyio('featureLocationList').css('display', data.length > 0 ? 'block' : 'none');
            Apperyio.processMappingAction(Apperyio.mappings["navigatePage_navigatePage_findFeaturedVendors_service_onsuccess_mapping_1"]);
        },
        "onError": function(jqXHR, textStatus, errorThrown) {}
    });
    Apperyio.CurrentScreen = 'navigatePage';
    _.chain(Apperyio.mappings)
        .filter(function(m) {
            return m.homeScreen === Apperyio.CurrentScreen;
        })
        .each(Apperyio.UIHandler.hideTemplateComponents);
    /*
     * Events and handlers
     */
    // On Load
    var navigatePage_onLoad = function() {
        navigatePage_elementsExtraJS();
        Apperyio.processMappingAction(Apperyio.mappings["navigatePage_navigatePage_onload_mapping_0"]);
        navigatePage_deviceEvents();
        navigatePage_windowEvents();
        navigatePage_elementsEvents();
    };
    // screen window events
    function navigatePage_windowEvents() {
        $('#navigatePage').bind('pageshow orientationchange', function() {
            var _page = this;
            adjustContentHeightWithPadding(_page);
        });
        $('#navigatePage').on({
            pageshow: function(event) {
                showQuickMessagePopup();
                if (storageGet('autoLocationPopup')) {
                    Apperyio('nearbyButton').trigger('click');
                    storageSet('autoLocationPopup', false);
                };
            },
        });
    };
    // device events
    function navigatePage_deviceEvents() {
        document.addEventListener("deviceready", function() {
        });
    };
    // screen elements extra js
    function navigatePage_elementsExtraJS() {
        // screen (navigatePage) extra code
        /* navigateList */
        listView = $("#navigatePage_navigateList");
        theme = listView.attr("data-theme");
        if (typeof theme !== 'undefined') {
            var themeClass = "ui-btn-up-" + theme;
            listItem = $("#navigatePage_navigateList .ui-li-static");
            $.each(listItem, function(index, value) {
                $(this).addClass(themeClass);
            });
        }
        /* nearbyButton */
        /* scanCodeButton */
        /* currentSelectionsButton */
        /* menuHistoryButton */
        /* favoritesButton */
        /* wishListButton */
        /* orderHistoryButton */
        /* searchPageReturnButton */
        /* updateProfileButton */
        /* settingsButton */
        /* helpButton */
        /* ratingInfoPageButton */
        /* logoutButton */
        /* logoutConfirmPopup */
        $("#navigatePage_logoutConfirmPopup").popup("option", "positionTo", "window");
        /* loginGotoPopup */
        $("#navigatePage_loginGotoPopup").popup("option", "positionTo", "window");
        /* quickMessagePopup */
        $("#navigatePage_quickMessagePopup").popup("option", "positionTo", "window");
        /* locationPopup */
        $("#navigatePage_locationPopup").popup("option", "positionTo", "window");
        /* featureLocationList */
        listView = $("#navigatePage_featureLocationList");
        theme = listView.attr("data-theme");
        if (typeof theme !== 'undefined') {
            var themeClass = "ui-btn-up-" + theme;
            listItem = $("#navigatePage_featureLocationList .ui-li-static");
            $.each(listItem, function(index, value) {
                $(this).addClass(themeClass);
            });
        }
        /* featureLocationListItem */
        /* locationList */
        listView = $("#navigatePage_locationList");
        theme = listView.attr("data-theme");
        if (typeof theme !== 'undefined') {
            var themeClass = "ui-btn-up-" + theme;
            listItem = $("#navigatePage_locationList .ui-li-static");
            $.each(listItem, function(index, value) {
                $(this).addClass(themeClass);
            });
        }
        /* locationItem */
    };
    // screen elements handler
    function navigatePage_elementsEvents() {
        $(document).on("click", "a :input,a a,a fieldset label", function(event) {
            event.stopPropagation();
        });
        $(document).off("click", '#navigatePage_navigateHeader [name="homeButton"]').on({
            click: function(event) {
                if (!$(this).attr('disabled')) {
                    Apperyio.navigateTo('zzsearchPage', {
                        transition: 'flip',
                        reverse: false
                    });
                }
            },
        }, '#navigatePage_navigateHeader [name="homeButton"]');
        $(document).off("click", '#navigatePage_navigateContainer [name="nearbyButton"]').on({
            click: function(event) {
                if (!$(this).attr('disabled')) {
                    try {
                        navigatePage_geolocation_service.execute({});
                    } catch (e) {
                        console.error(e);
                        hideSpinner();
                    };
                }
            },
        }, '#navigatePage_navigateContainer [name="nearbyButton"]');
        $(document).off("click", '#navigatePage_navigateContainer [name="scanCodeButton"]').on({
            click: function(event) {
                if (!$(this).attr('disabled')) {
                    try {
                        navigatePage_mobilebarcode.execute({});
                    } catch (e) {
                        console.error(e);
                        hideSpinner();
                    };
                }
            },
        }, '#navigatePage_navigateContainer [name="scanCodeButton"]');
        $(document).off("click", '#navigatePage_navigateContainer [name="currentSelectionsButton"]').on({
            click: function(event) {
                if (!$(this).attr('disabled')) {
                    Apperyio.navigateTo('selectedPage', {
                        transition: 'slide',
                        reverse: false
                    });
                }
            },
        }, '#navigatePage_navigateContainer [name="currentSelectionsButton"]');
        $(document).off("click", '#navigatePage_navigateContainer [name="menuHistoryButton"]').on({
            click: function(event) {
                if (!$(this).attr('disabled')) {
                    navigatePageManager.menuHistoryButton_onClick();
                }
            },
        }, '#navigatePage_navigateContainer [name="menuHistoryButton"]');
        $(document).off("click", '#navigatePage_navigateContainer [name="favoritesButton"]').on({
            click: function(event) {
                if (!$(this).attr('disabled')) {
                    if (isGuest) {
                        Apperyio('loginGotoPopup').popup('open');
                    } else {
                        Apperyio.navigateTo('favoritesPage', {
                            transition: 'slide'
                        });
                    };
                }
            },
        }, '#navigatePage_navigateContainer [name="favoritesButton"]');
        $(document).off("click", '#navigatePage_navigateContainer [name="wishListButton"]').on({
            click: function(event) {
                if (!$(this).attr('disabled')) {
                    if (isGuest) {
                        Apperyio('loginGotoPopup').popup('open');
                    } else {
                        Apperyio.navigateTo('wishListPage', {
                            transition: 'slide'
                        });
                    };
                }
            },
        }, '#navigatePage_navigateContainer [name="wishListButton"]');
        $(document).off("click", '#navigatePage_navigateContainer [name="orderHistoryButton"]').on({
            click: function(event) {
                if (!$(this).attr('disabled')) {
                    if (isGuest) {
                        Apperyio('loginGotoPopup').popup('open');
                    } else {
                        Apperyio.navigateTo('orderHistoryPage', {
                            transition: 'slide'
                        });
                    };
                }
            },
        }, '#navigatePage_navigateContainer [name="orderHistoryButton"]');
        $(document).off("click", '#navigatePage_navigateContainer [name="searchPageReturnButton"]').on({
            click: function(event) {
                if (!$(this).attr('disabled')) {
                    if (isGuest) {
                        Apperyio('loginGotoPopup').popup('open');
                    } else {
                        Apperyio.navigateTo('searchPage', {
                            transition: 'slide'
                        });
                    };
                }
            },
        }, '#navigatePage_navigateContainer [name="searchPageReturnButton"]');
        $(document).off("click", '#navigatePage_navigateContainer [name="updateProfileButton"]').on({
            click: function(event) {
                if (!$(this).attr('disabled')) {
                    if (isGuest) {
                        Apperyio('loginGotoPopup').popup('open');
                    } else {
                        Apperyio.navigateTo('profilePage', {
                            transition: 'slide'
                        });
                    };
                }
            },
        }, '#navigatePage_navigateContainer [name="updateProfileButton"]');
        $(document).off("click", '#navigatePage_navigateContainer [name="settingsButton"]').on({
            click: function(event) {
                if (!$(this).attr('disabled')) {
                    if (isGuest) {
                        Apperyio('loginGotoPopup').popup('open');
                    } else {
                        Apperyio.navigateTo('settingsPage', {
                            transition: 'slide'
                        });
                    };
                }
            },
        }, '#navigatePage_navigateContainer [name="settingsButton"]');
        $(document).off("click", '#navigatePage_navigateContainer [name="helpButton"]').on({
            click: function(event) {
                if (!$(this).attr('disabled')) {
                    Apperyio.navigateTo('helpPage', {
                        transition: 'slide',
                        reverse: false
                    });
                }
            },
        }, '#navigatePage_navigateContainer [name="helpButton"]');
        $(document).off("click", '#navigatePage_navigateContainer [name="ratingInfoPageButton"]').on({
            click: function(event) {
                if (!$(this).attr('disabled')) {
                    if (isGuest) {
                        Apperyio('loginGotoPopup').popup('open');
                    } else {
                        Apperyio.navigateTo('ratingInfoPage', {
                            transition: 'slide'
                        });
                    };
                }
            },
        }, '#navigatePage_navigateContainer [name="ratingInfoPageButton"]');
        $(document).off("click", '#navigatePage_navigateContainer [name="logoutButton"]').on({
            click: function(event) {
                if (!$(this).attr('disabled')) {
                    var popupElement = Apperyio("logoutConfirmPopup");
                    if (popupElement.popup("option", "positionTo") === "origin") {
                        popupElement.popup("open", {
                            transition: "pop",
                            positionTo: "#" + $(this).attr("id")
                        });
                    } else {
                        popupElement.popup("open", {
                            transition: "pop"
                        });
                    };
                }
            },
        }, '#navigatePage_navigateContainer [name="logoutButton"]');
        $(document).off("click", '#navigatePage_navigateContainer [name="vendotOptionsButton"]').on({
            click: function(event) {
                if (!$(this).attr('disabled')) {
                    Apperyio.navigateTo('proprietorStartPage', {
                        transition: 'slide',
                        reverse: false
                    });
                }
            },
        }, '#navigatePage_navigateContainer [name="vendotOptionsButton"]');
        $(document).off("click", '#navigatePage_logoutConfirmPopup [name="logoutConfirmButton"]').on({
            click: function(event) {
                if (!$(this).attr('disabled')) {
                    Apperyio('logoutConfirmPopup').popup('close');
                    if (isFacebook) {
                        Apperyio.User.logout(get_db_id());
                        navigatePageManager.navigatePage_logout_service_onSuccess({});
                    } else {
                        navigatePage_logout_service.execute();
                    };
                }
            },
        }, '#navigatePage_logoutConfirmPopup [name="logoutConfirmButton"]');
        $(document).off("click", '#navigatePage_logoutConfirmPopup [name="logoutCancelButton"]').on({
            click: function(event) {
                if (!$(this).attr('disabled')) {
                    Apperyio('logoutConfirmPopup').popup('close');
                }
            },
        }, '#navigatePage_logoutConfirmPopup [name="logoutCancelButton"]');
        $(document).off("click", '#navigatePage_loginGotoPopup [name="loginGotoButton"]').on({
            click: function(event) {
                if (!$(this).attr('disabled')) {
                    Apperyio('loginGotoPopup').popup('close');
                    setTimeout(function() {
                        window.location = 'startScreen.html';
                    }, 0);
                }
            },
        }, '#navigatePage_loginGotoPopup [name="loginGotoButton"]');
        $(document).off("click", '#navigatePage_loginGotoPopup [name="loginGotoCancelButton"]').on({
            click: function(event) {
                if (!$(this).attr('disabled')) {
                    Apperyio('loginGotoPopup').popup('close');
                }
            },
        }, '#navigatePage_loginGotoPopup [name="loginGotoCancelButton"]');
        $(document).off("click", '#navigatePage_locationPopup [name="locationCancelButton"]').on({
            click: function(event) {
                if (!$(this).attr('disabled')) {
                    Apperyio('locationPopup').popup('close');
                }
            },
        }, '#navigatePage_locationPopup [name="locationCancelButton"]');
        $(document).off("click", '#navigatePage_locationPopup [name="featureLocationListItem"]').on({
            click: function(event) {
                if (!$(this).attr('disabled')) {
                    proceedAsGuest(null, this, window.navigatePage_findFeaturedVendors, false);
                }
            },
        }, '#navigatePage_locationPopup [name="featureLocationListItem"]');
        $(document).off("click", '#navigatePage_locationPopup [name="locationItem"]').on({
            click: function(event) {
                if (!$(this).attr('disabled')) {
                    proceedAsGuest(null, this, window.navigatePage_findNearestVendors, false);
                }
            },
        }, '#navigatePage_locationPopup [name="locationItem"]');
    };
    $(document).off("pagebeforeshow", "#navigatePage").on("pagebeforeshow", "#navigatePage", function(event, ui) {
        Apperyio.CurrentScreen = "navigatePage";
        _.chain(Apperyio.mappings)
            .filter(function(m) {
                return m.homeScreen === Apperyio.CurrentScreen;
            })
            .each(Apperyio.UIHandler.hideTemplateComponents);
    });
    navigatePage_onLoad();
};
$(document).off("pagecreate", "#navigatePage").on("pagecreate", "#navigatePage", function(event, ui) {
    Apperyio.processSelectMenu($(this));
    navigatePage_js();
});